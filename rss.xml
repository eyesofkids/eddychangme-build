<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[eddychang部落格]]></title><description><![CDATA[Eddy Chang的個人部落格]]></description><link>https://eddychang.me</link><generator>RSS for Node</generator><lastBuildDate>Wed, 13 Mar 2019 18:26:37 GMT</lastBuildDate><item><title><![CDATA[在Visual Studio Code中的React Native專案設定ESLint與Prettier]]></title><link>https://eddychang.me/react-native-eslint-prettier/</link><guid isPermaLink="false">https://eddychang.me/react-native-eslint-prettier/</guid><content:encoded>&lt;h2&gt;前言&lt;/h2&gt;
&lt;p&gt;React Native 專案並沒有內建 eslint 模組，所以需要在專案建立後手動進行設定。有很多種設定的方式，這裡是使用 react-app 的設定值(Create React App 使用的)為基礎，以及針對 Visual Studio Code 編輯器的設定，其它設定方式可再參考最後的參考資料中的設定。&lt;/p&gt;
&lt;h2&gt;步驟&lt;/h2&gt;
&lt;h3&gt;步驟一: 建立新的專案&lt;/h3&gt;
&lt;p&gt;以 expo 或其它建立方式建立專案。&lt;/p&gt;
&lt;h3&gt;步驟二: 安裝 VS Code 擴充&lt;/h3&gt;
&lt;p&gt;安裝以下兩個 VS Code 擴充:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ESLint&lt;/li&gt;
&lt;li&gt;Prettier&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;註: Prettier 的擴充有好幾套，請先安裝下載量最多的即可，除非有不能使用的情況再安裝別套。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;步驟三: 安裝模組&lt;/h3&gt;
&lt;p&gt;在終端機裡，對應專案的根目錄，輸入以下的指令(選擇其中一種即可，如果已經有安裝 yarn 建議使用上面這個):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;yarn add -D eslint-plugin-prettier prettier eslint-config-react-app eslint-plugin-import eslint-plugin-react eslint-plugin-flowtype eslint-plugin-jsx-a11y babel-eslint eslint&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;或&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;npm install --save-dev eslint-plugin-prettier prettier eslint-config-react-app eslint-plugin-import eslint-plugin-react eslint-plugin-flowtype eslint-plugin-jsx-a11y babel-eslint eslint&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 每個專案都要安裝一次，這是安裝到專案中的模組&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;注意: 最好不要把 eslint 與相關模組安裝到全域中&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;步驟四: 更新 VS Code 設定&lt;/h3&gt;
&lt;p&gt;請將以下的設定加到你的 VSCode 使用者設定之中(在選單 -&gt; 喜好設定 -&gt; 設定，然後點按右上角有個&lt;code class=&quot;language-text&quot;&gt;{}&lt;/code&gt;的圖示，直接貼到右邊的視窗中的花括號內即可)：&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;
      &lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;  &lt;span class=&quot;token property&quot;&gt;&quot;editor.formatOnSave&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;[javascript]&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;editor.formatOnSave&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;prettier.disableLanguages&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;js&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;eslint.autoFixOnSave&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;eslint.alwaysShowStatus&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;files.autoSave&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;onFocusChange&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 這個只需要設定一次，之後所有專案都可以使用&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;步驟五: 加入 eslint 與 prettier 設定檔案&lt;/h3&gt;
&lt;p&gt;手動建立兩個 &lt;code class=&quot;language-text&quot;&gt;.eslintrc&lt;/code&gt; 與 &lt;code class=&quot;language-text&quot;&gt;.prettierrc&lt;/code&gt; 的設定檔到專案的根目錄。內容如下節內容，最好是先建立好，之後每個專案直接拷貝即可。&lt;/p&gt;
&lt;h2&gt;eslint 與 prettier 設定檔案內容&lt;/h2&gt;
&lt;p&gt;.eslintrc&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;
      &lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;env&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;node&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;browser&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;es6&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;jest&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;extends&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;react-app&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;parser&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;babel-eslint&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;plugins&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;prettier&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;rules&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;&quot;prettier/prettier&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;error&quot;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;.prettierrc&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;json&quot;&gt;
      &lt;pre class=&quot;language-json&quot;&gt;&lt;code class=&quot;language-json&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;singleQuote&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;trailingComma&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;es5&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;&quot;semi&quot;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 風格可依個人喜好設定，請參考 &lt;a href=&quot;https://prettier.io/docs/en/options.html&quot;&gt;prettier 選項文件&lt;/a&gt;，以上設定為”字串使用單引號”、“物件字面定義統一加上最後逗號”、“不使用分號作為語句結尾”&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;故障排除&lt;/h2&gt;
&lt;h3&gt;eslint 不會正常檢查&lt;/h3&gt;
&lt;p&gt;使用以下的指令來除錯，看有什麼錯誤訊息，然後到網路中搜尋:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;eslint --debug App.js&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;再次重頭檢查所有的相關設定，可能會包含以下幾個:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;vscode 的版本是不是有升級到最新版本&lt;/li&gt;
&lt;li&gt;vscode 裡擴充是否有安裝&lt;/li&gt;
&lt;li&gt;vscode 裡的喜好設定是否有正確，或出現錯誤的訊息&lt;/li&gt;
&lt;li&gt;專案裡是否正確安裝所需模組(看 package.json 裡)&lt;/li&gt;
&lt;li&gt;是否有安裝到全或的 eslint 模組，有可能造成衝突&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;參考資料&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://medium.com/appstud/setup-eslint-and-prettier-together-for-react-and-react-native-projects-in-visual-studio-code-78772d58358d&quot;&gt;Setup ESLint and Prettier together for react and react-native projects in Visual Studio Code&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/airbnb/javascript/issues/1589#issuecomment-344097023&quot;&gt;How to configure React Native (Expo) project to use AirBnB’s React rules via ESLint? #1589&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;com/format-code-style-with-prettier-in-react-native-1e10e6b7169f&quot;&gt;Format Code Style with Prettier in React Native&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[新的部落格上線了！]]></title><link>https://eddychang.me/new-blog/</link><guid isPermaLink="false">https://eddychang.me/new-blog/</guid><content:encoded>&lt;p&gt;新的部落格正式上線了(2019/03/08)。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;改使用 gatsby 的方式產生網頁，樣版使用&lt;a href=&quot;https://github.com/greglobinski/gatsby-starter-personal-blog&quot;&gt;gatsby-starter-personal-blog&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;原有的部落格文章將會先放在&lt;a href=&quot;https://oldblog.eddychang.me&quot;&gt;https://oldblog.eddychang.me&lt;/a&gt;中，之後會將還能使用與參考的文章移到新的部落格之中。&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[React Native專案建立方式]]></title><link>https://eddychang.me/react-native-project-start-step/</link><guid isPermaLink="false">https://eddychang.me/react-native-project-start-step/</guid><content:encoded>&lt;h2&gt;前言&lt;/h2&gt;
&lt;p&gt;自從 Create React Native App(CRNA) 這個專案在 2018 年 9 月&lt;a href=&quot;https://github.com/react-community/create-react-native-app/blob/master/CHANGELOG.md&quot;&gt;宣布棄用&lt;/a&gt;，與 Expo 工具合併後，建立 React Native 專案的方式，又變得有點不太一樣。未來有可能還會再變動。&lt;/p&gt;
&lt;h2&gt;方式一: 使用 Expo CLI&lt;/h2&gt;
&lt;h3&gt;說明&lt;/h3&gt;
&lt;p&gt;Expo CLI 命令列工具是最簡單的方式，也是目前 React Native 官方網站中，推薦入門開發者使用的方式。使用時同時可以到 &lt;a href=&quot;https://expo.io/&quot;&gt;expo.io&lt;/a&gt; 網站註冊一個帳號，這雖然不一定是必要的，但可以在開發時有一些協助的功能。&lt;/p&gt;
&lt;p&gt;優點:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;開發過程相對簡單，電腦上也不需要安裝 Android Studio 或 Xcode&lt;/li&gt;
&lt;li&gt;已內建許多常用的模組與套件，不需要到處找與測試合適的套件&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;缺點:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;無法使用需要執行&lt;code class=&quot;language-text&quot;&gt;react-native link&lt;/code&gt;才能安裝的套件&lt;/li&gt;
&lt;li&gt;以 Expo 建立的專案，編譯後會多佔掉一些空間&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;步驟&lt;/h3&gt;
&lt;p&gt;使用 npm 或 yarn 安裝 Expo CLI:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;npm install -g expo-cli&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;使用 Expo CLI 建立新的專案:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;expo init my-app&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;使用 Expo CLI 啟動專案:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;expo start&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;App 執行的部份，可以使用實體手機，安裝 Expo 所提供的 App，在同一網路區域中即可執行。也可以使用電腦中安裝的手機模擬器。&lt;/p&gt;
&lt;p&gt;Expo CLI 還有其它相關操作的指令，請參考&lt;a href=&quot;https://docs.expo.io/versions/v32.0.0/workflow/expo-cli/#commands&quot;&gt;這裡的說明, v32.0.0&lt;/a&gt;。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意建立專案時的選項，不要選用有&lt;code class=&quot;language-text&quot;&gt;實驗性質(experimental)&lt;/code&gt;字詞的，用這些選項建立出來的專案，可能會有後續的很多問題。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;方式二: 使用 Expo CLI 建立專案，然後 eject&lt;/h2&gt;
&lt;h3&gt;說明&lt;/h3&gt;
&lt;p&gt;以原本 Expo CLI 來建立新的專案，但為了要使用自訂的套件，通常是為了某些需要以&lt;code class=&quot;language-text&quot;&gt;react-native link&lt;/code&gt;才能安裝使用的套件。&lt;/p&gt;
&lt;p&gt;這種方式仍然可以使用 Expo CLI 的發佈功能，以及大部份的、內建的 Expo SDK。不過會無法再使用某一些 Expo 所提供的內建功能(例如 push notification(推播通知))，詳請請見&lt;a href=&quot;https://docs.expo.io/versions/v32.0.0/expokit/eject/&quot;&gt;Ejecting to ExpoKit&lt;/a&gt;的詳細說明。&lt;/p&gt;
&lt;p&gt;最重要的一點，電腦中必需要安裝 Android Studio 或 Xcode，App 需要這兩個開發工具來進行編譯才能執行。&lt;/p&gt;
&lt;h3&gt;步驟&lt;/h3&gt;
&lt;p&gt;建立專案的方式與第一個方式相同，建立後使用以下命令作 eject:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;expo eject&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;執行時需要先啟動專案，和之前一樣。這是作為類似開發伺服器的地位:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;expo start&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;至於 App 執行部份，需要用 Android Studio 或 Xcode 開啟專案中的對應目錄(android 或 ios)，然後進行打包(build)與執行。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 實際上要花一些時間調整執行環境，例如 ios 部份需要額外安裝 CocoaPods，以及執行&lt;code class=&quot;language-text&quot;&gt;pod install&lt;/code&gt;，而 android 的部份相對簡單。請參考&lt;a href=&quot;https://docs.expo.io/versions/v32.0.0/expokit/expokit/&quot;&gt;Developing With ExpoKit&lt;/a&gt;這裡的說明。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;方式三: 使用 React Native CLI&lt;/h2&gt;
&lt;h3&gt;說明&lt;/h3&gt;
&lt;p&gt;這個方式是完全使用 React Native CLI 來建立、執行專案，環境建置過程較為麻煩。電腦中需要先安裝好 Android Studio 或 Xcode 執行環境。&lt;/p&gt;
&lt;p&gt;這個方式比較適合已經對於 Android Studio 或 Xcode 熟悉的開發者。它是一種最原始的建立 React Native 專案的方式，要搭配的套件都需要額外去尋找和安裝。這種方式並不適合入門開發者。&lt;/p&gt;
&lt;h3&gt;步驟&lt;/h3&gt;
&lt;p&gt;參考&lt;a href=&quot;https://facebook.github.io/react-native/docs/getting-started&quot;&gt;官網的 Getting Started&lt;/a&gt;的說明。&lt;/p&gt;
&lt;h2&gt;方式四: 其它專案樣版&lt;/h2&gt;
&lt;h3&gt;說明&lt;/h3&gt;
&lt;p&gt;ignite 很像上面第三種方式的擴充加強版，它有包裝一些模組(稱為外掛，大約 20 套)到建立的專案中，也有提供一些專案不同的樣版可以選擇。執行時仍然是與第三種方式相同的方式來執行。&lt;/p&gt;
&lt;p&gt;因此，像 ignite 也不適合初學者使用，雖然它內附了不少常用的模組和第三方函式庫工具，對於熟悉這些工具的開發者會較為實用，用它可以節省一些安裝這些工具的時間。&lt;/p&gt;
&lt;p&gt;目前像這種專案樣版計劃，可能只剩下 ignite 還有在更新，其它的計劃(例如 snowflake 或 pepperoni-app-kit)都沒在更新了，已經很久沒有更新的不要再考慮使用。&lt;/p&gt;
&lt;h2&gt;步驟&lt;/h2&gt;
&lt;p&gt;參考&lt;a href=&quot;https://facebook.github.io/react-native/docs/getting-started&quot;&gt;Ignite CLI Documentation&lt;/a&gt;的說明。&lt;/p&gt;</content:encoded></item><item><title><![CDATA[區域網路用Gatsby Develop測試]]></title><link>https://eddychang.me/test-gatsby-in-lan/</link><guid isPermaLink="false">https://eddychang.me/test-gatsby-in-lan/</guid><content:encoded>&lt;p&gt;測試 Gatsby 時，使用下面的指令只能在同一台機器上用 &lt;code class=&quot;language-text&quot;&gt;localhost&lt;/code&gt; 測試:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;gatsby develop&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;如果你想要在同區域網路(或無線網路)的手機、其它電腦上的瀏覽器來測試時，可以改用以下的指令來啟動測試伺服器(-H 是 host 的意思):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;gatsby develop -H 0.0.0.0 -p 8000&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;之後手機或其它電腦的瀏覽器可以直接輸入 ip 加上埠號來測試，例如&lt;code class=&quot;language-text&quot;&gt;http://192.168.2.105:8000/&lt;/code&gt;就可以看到網站畫面。&lt;/p&gt;
&lt;p&gt;另外也有使用電腦 hostname 的方式，請再參考官方的 Github 中&lt;a href=&quot;https://github.com/gatsbyjs/gatsby/issues/5801&quot;&gt;issue #5801&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[React Native 中使用 Flexbox 筆記]]></title><link>https://eddychang.me/flex-react-native/</link><guid isPermaLink="false">https://eddychang.me/flex-react-native/</guid><content:encoded>&lt;p&gt;Flexbox 排版的全名是&lt;a href=&quot;https://www.w3.org/TR/css-flexbox/&quot;&gt;Flexible Box Layout Module&lt;/a&gt;(彈性的盒排版模組)，是由 W3C 所制定的 CSS3 排版模組。Flexbox 的目的是提供更有效率的排版、對齊與分佈空格在容器之中的項目，甚至是在項目的尺寸大小是未知或動態的情況。&lt;/p&gt;
&lt;p&gt;Flexbox 排版適合於應用程式中的元件，以及小型規模的排版。W3C 也另外制定了一個&lt;a href=&quot;https://www.w3.org/TR/css-grid-1/&quot;&gt;Grid 排版模組&lt;/a&gt;，這是適合使用於大型規模排版情況。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;註: Flex 的中文意思是”彈性的”、“靈活的”，box 的中文意思是”盒子”、“箱子”。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;Yoga 專案&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/facebook/yoga&quot;&gt;Yoga&lt;/a&gt; 是一個實作了 Flexbox 的跨平台排版引擎，由 Facebook 主導，前身的名稱為 css-layout。Yoga 主要以 C 語言開發，提供高執行效能與易於整合其它語言，可以讓開發者在不同的平台中使用 Flexbox 來進行排版的工作，主要是應用在手機 App 的開發上，當然它也是目前 React Native 使用的排版引擎。&lt;/p&gt;
&lt;p&gt;Yoga 中採用了與 CSS3 標準裡 Flexbox 相近的語法與方式，但因為 CSS3 中的標準與內容相當多，Yogo 中的 Flexbox 並沒有完全支援所有的特性，而進行部份的簡化，在 React Native 中使用的預設值與網頁上也不相同，所以在使用過程中要特別注意的。&lt;/p&gt;
&lt;h2&gt;Flexbox 使用的英文專業字詞&lt;/h2&gt;
&lt;p&gt;要學習 Flexbox 並不困難，很多內容都是很直覺式的，如果你已經是對網頁設計或 HTML 語法有一定基礎的開發者，很容易就可以學習開始使用。不過，因為這是外國人寫的標準，有一些專有名詞反倒是會造成一知半解的情況，我先把會用到的幾個英文名詞寫在下面，先理解一下這些名詞所代表的意思，後面學習會容易得多。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;flex: 有”彈性”、“彎曲”的意思，通常作為動詞用。flexible(彈性的)是這個字詞的形容詞。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;axis: 有”坐標軸”、“基準線”的意思。Flexbox 使用 main axis(主基準線)與 cross axis(相反基準線)來區分水平與垂直的兩個不同的基準線，main axis(主基準線)代表的主要的基準線，依照 flexDirection 的屬性來決定主基準線是水平的還是垂直的方向。cross axis(相反基準線)則是與主基準線相反的基準線。基準線代表的是容器(container)中的項目排列時按照的方向規範。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;React Native 預設的方向(flexDirection)是 column，也就是”&lt;strong&gt;垂直的&lt;/strong&gt;“，所以它的主基準線(main axis)預設就是”&lt;strong&gt;垂直的&lt;/strong&gt;“，相反基準線(cross axis)則是水平的。這會與網頁中 CSS 的預設值相反。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;container 與 items: container(容器)中裝有 items(項目)，這兩個在 DOM 元素中有 父母-子女(parent-children) 關係。Flexbox 的排列、對齊、方向等等屬性是在 &lt;strong&gt;container(容器)&lt;/strong&gt; 中定義的，當然這是指對容器中的項目們所作的屬性定義。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;grow、shrink、basis: 這三個是項目的屬性定義值。grow 有”成長”、“變大”的意思，shrink 則有”收縮”、“縮水”的意思。basis 則是”基礎”、“標準”的意思。這三個是用於項目(元件)的”&lt;strong&gt;彈性&lt;/strong&gt;“屬性，也就是在版面或外部容器的尺寸變動時，項目應該如何隨之進行變動。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;React Native 中自 0.42 版後才加入 flexGrow、flexShrink、flexBasis 這三個屬性，使用上會有些複雜，請參考&lt;a href=&quot;https://stackoverflow.com/questions/43143258/flex-vs-flexgrow-vs-flexshrink-vs-flexbasis-in-react-native&quot;&gt;flex vs flexGrow vs flexShrink vs flexBasis in React Native?&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;wrap、nowrap、wrap-reverse: wrap 有”包裝”的意思，但用在這裡是代表要不要擠在同一行之中，&lt;code class=&quot;language-text&quot;&gt;nowrap&lt;/code&gt;代表這個容器中的項目是只能擠在同一行之中，&lt;code class=&quot;language-text&quot;&gt;wrap&lt;/code&gt;則是允許多行。&lt;code class=&quot;language-text&quot;&gt;wrap-reverse&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;wrap&lt;/code&gt;一樣可以允許多行，但開始與結束會顛倒過來。&lt;code class=&quot;language-text&quot;&gt;-reverse&lt;/code&gt;字詞很常見，它是”顛倒”的意思。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;align-items、align-self、align-content: align 是”對齊”的意思。align-self 是用於項目(元件)的屬性，align-items 與 align-content 是用於容器的屬性，都是用來作對齊使用的。這幾個都是應用在 cross axis(相反基準線)時。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;stretch: “伸展”的意思，用在這是是填好填滿的意思。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;justify-content: justify 也有”對齊”的意思，它是用在 main axis(主基準線)時的對齊。這是用於容器的屬性。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;flow: flow 是”流動”的意思，在這裡的意思是排列的情況。flex-flow 是 flex-direction 與 flex-wrap 的組合簡寫法，合稱&lt;code class=&quot;language-text&quot;&gt;dw&lt;/code&gt;。(註: React Native 中沒這個屬性)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;order: “順序”的意思，項目(元件)的屬性，代表這個項目(元件)在容器中的排列次序。(註: React Native 中沒這個屬性)&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;justifyContent 詳細說明&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;預設值: &lt;code class=&quot;language-text&quot;&gt;flex-start&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;justifyContent&lt;/code&gt;是針對 main axis(主基準線)的對齊，對 React Native 來說，main axis(主基準線)預設是從上到下的垂直方向。有以下幾個屬性值可使用:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;flex-start (預設值): 以開始線來對齊，例如從右至左的排列方向，最右邊即是開始線。&lt;/li&gt;
&lt;li&gt;flex-end: 以結束線來對齊，和上面的屬性顛倒。&lt;/li&gt;
&lt;li&gt;center: 以中線來對齊。&lt;/li&gt;
&lt;li&gt;space-between: 項目會平均分散對齊，第一個項目會位於開始線，最後一個項目位於結束線。&lt;/li&gt;
&lt;li&gt;space-around: 項目會平均分散對齊，每個項目之間約有二個單位的空格，第一個項目會與開始線之間有一個單位的空格，最後一個項目與結束線之間也有一個單位的空格。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;alignItems&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;預設值: &lt;code class=&quot;language-text&quot;&gt;stretch&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;特別注意: 預設情況(水平方向)如果給定 width 屬性，會導致設置 &lt;code class=&quot;language-text&quot;&gt;stretch&lt;/code&gt; 值無效果&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;重點: alignItems 是 justifyContent 的相反屬性(不要誤以為是 alignContent)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;alignItems&lt;/code&gt;則是針對 cross axis(相反基準線)的對齊，對 React Native 來說，cross axis(相反基準線)預設是從左到右的水平方向。適合於項目是單行排列的情況。有以下幾個屬性:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;flex-start: 以 cross axis(相反基準線)的開始線來對齊。&lt;/li&gt;
&lt;li&gt;flex-end: 以 cross axis(相反基準線)的結束線來對齊。&lt;/li&gt;
&lt;li&gt;center: 以 cross axis(相反基準線)的中心線來對齊。&lt;/li&gt;
&lt;li&gt;baseline: 項目會依照它們的 baseline 來對齊。(baseline 預設是 DOM 元素呈現的最下面位置)&lt;/li&gt;
&lt;li&gt;stretch (預設值): 伸展填好填滿容器(注意仍然會受到 min-width/max-width 的限制，也就是項目的高度或寬度限制)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;alignContent&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;注意: alignContent 只有在項目被 flexWrap 包裹(wrapped)成為多行排列時，才會發生作用&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;alignContent&lt;/code&gt;也是針對 cross axis(相反基準線)的對齊對 React Native 來說，cross axis(相反基準線)預設是從左到右的水平方向。它適合於 cross axis(相反基準線)有空白的情況，以及項目是以多行排列的情況。&lt;/p&gt;
&lt;p&gt;屬性值與&lt;code class=&quot;language-text&quot;&gt;justifyContent&lt;/code&gt;類似，但多了一個 stretch:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;flex-start: 以開始線來對齊，例如從右至左的排列方向，最右邊即是開始線。&lt;/li&gt;
&lt;li&gt;flex-end: 以結束線來對齊，和上面的屬性顛倒。&lt;/li&gt;
&lt;li&gt;center: 以中線來對齊。&lt;/li&gt;
&lt;li&gt;space-between: 項目會平均分散對齊，第一個項目會位於開始線，最後一個項目位於結束線。&lt;/li&gt;
&lt;li&gt;space-around: 項目會平均分散對齊，每個項目之間約有二個單位的空格，第一個項目會與開始線之間有一個單位的空格，最後一個項目與結束線之間也有一個單位的空格。&lt;/li&gt;
&lt;li&gt;stretch (預設值): 伸展填好填滿容器(注意仍然會受到 min-width/max-width 的限制，也就是項目的高度或寬度限制)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;項目的自我對齊&lt;code class=&quot;language-text&quot;&gt;alignSelf&lt;/code&gt;&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;注意: 這是單個&lt;strong&gt;項目&lt;/strong&gt;用來覆蓋&lt;strong&gt;容器&lt;/strong&gt;裡的&lt;code class=&quot;language-text&quot;&gt;alignItems&lt;/code&gt;值，有必要才會使用&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;這個自我對齊&lt;code class=&quot;language-text&quot;&gt;alignSelf&lt;/code&gt;項目屬性是用來覆蓋在容器裡設定的&lt;code class=&quot;language-text&quot;&gt;alignItems&lt;/code&gt;，作為個別項目自己的對齊方式，除非有必要才會使用。預設值是&lt;code class=&quot;language-text&quot;&gt;auto&lt;/code&gt;，其他屬性與&lt;code class=&quot;language-text&quot;&gt;alignItems&lt;/code&gt;一樣:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;auto (預設值): 自動。&lt;/li&gt;
&lt;li&gt;flex-start: 以 cross axis(相反基準線)的開始線來對齊。&lt;/li&gt;
&lt;li&gt;flex-end: 以 cross axis(相反基準線)的結束線來對齊。&lt;/li&gt;
&lt;li&gt;center: 以 cross axis(相反基準線)的中心線來對齊。&lt;/li&gt;
&lt;li&gt;baseline: 項目會依照它們的 baseline 來對齊。(baseline 預設是 DOM 元素呈現的最下面位置)&lt;/li&gt;
&lt;li&gt;stretch: 伸展填好填滿容器(注意仍然會受到 min-width/max-width 的限制，也就是項目的高度或寬度限制)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;Flexbox 定義步驟說明&lt;/h2&gt;
&lt;h3&gt;第零步: 容器與項目的標記&lt;/h3&gt;
&lt;p&gt;Flexbox 需要有容器與項目的層級結構，才能進行相對的排版，例如以下的範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;javascript&quot;&gt;
      &lt;pre class=&quot;language-javascript&quot;&gt;&lt;code class=&quot;language-javascript&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;styles&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;container&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;styles&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;row&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;styles&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;row&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;styles&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;row&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;styles&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;row&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;第一步: 定義容器&amp;#x26;項目的屬性&lt;code class=&quot;language-text&quot;&gt;flex: 1&lt;/code&gt;&lt;/h3&gt;
&lt;p&gt;所有的 View 元件預設是&lt;code class=&quot;language-text&quot;&gt;flex: 0&lt;/code&gt;，所以你要自行定義&lt;code class=&quot;language-text&quot;&gt;flex&lt;/code&gt;值才能進行排版。定義之後，容器會有一些預設的屬性加上，即使你沒有寫上&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; styles &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; StyleSheet&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  container&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    backgroundColor&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;#ccc&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  row&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;container 會有以下的自動(預設)的屬性:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;flexDirection: ‘column’&lt;/li&gt;
&lt;li&gt;flexWrap: ‘nowrap’&lt;/li&gt;
&lt;li&gt;justifyContent: ‘flex-start’&lt;/li&gt;
&lt;li&gt;alignItems: ‘stretch’&lt;/li&gt;
&lt;li&gt;alignContent: ‘flex-start’ (註: 需要配合 &lt;code class=&quot;language-text&quot;&gt;flexWrap: &amp;#39;wrap&amp;#39;&lt;/code&gt; 出現多列時才會有效果)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;由此可知這樣設定，會出現以下的排版:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;flex:1&lt;/code&gt; 相當於 &lt;code class=&quot;language-text&quot;&gt;height: 100%&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;alignItems: &amp;#39;stretch&amp;#39;&lt;/code&gt; 相當於 &lt;code class=&quot;language-text&quot;&gt;width: 100%&lt;/code&gt; (每個項目)&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;第二步: 定義容器的&lt;code class=&quot;language-text&quot;&gt;flexDirection&lt;/code&gt;，控制主基準線是垂直還水平方向&lt;/h3&gt;
&lt;p&gt;flexDirection 在 RN 中預設是 column，也就是垂直排列(由上到下)的。&lt;/p&gt;
&lt;h3&gt;第三步: 定義容器的&lt;code class=&quot;language-text&quot;&gt;flexWrap&lt;/code&gt;，控制裡面的項目是單行還多行排序。&lt;/h3&gt;
&lt;p&gt;flexWrap 在 RN 中預設是 nowrap，也就是單列或單行的排列。&lt;/p&gt;
&lt;h3&gt;項目所佔比例&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;flex 的數值相當於 flex-grow&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;利用 flex 的數值，可以劃分出每個項目所佔的比例值，例如下面的例子會讓後面兩列佔的比例為 2/(1+1+2+2) 也就是 1/3，前面兩列為 1/6:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;styles&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;container&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;使用對應的比例數字也是相同的結果:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;styles&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;container&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;6&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;或&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;styles&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;container&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.16&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.16&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.33&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0.33&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;4&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 當 flex 數字為小數點數字，但沒有加起來剛好為 1 時，會呈現有多餘空間的情況。所以使用整數可能會是比較好的比例劃分方式。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 由於在垂直排列(flexDirection: column)時，flexbox 取代了 height 的樣式定義方式，所以再對 View 定義 height 是不會有作用的，例如將上面例子中的 Row-1 改為下面的設定，你會發現 height 不管設大或設小都沒作用。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View
  style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    width&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    height&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    backgroundColor&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;#ff0&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;Row&lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;Text&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 只有 View 元件可以使用 flexbox 排版，Text 元件有自己的排版方式&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 使用 StyleSheet 建立和直接使用物件字面定義的樣式有不同之處，上面範例只是為了展示之用，正常情況下仍然建議使用 StyleSheet 來建立。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;flexbox in RN&lt;/h2&gt;
&lt;h3&gt;與 CSS3 相較的不同處&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;flexDirection 預設為&lt;code class=&quot;language-text&quot;&gt;column&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;alignItems 預設為&lt;code class=&quot;language-text&quot;&gt;stretch&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;flex 只能用&lt;strong&gt;一個數字&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;預設情況&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;css&quot;&gt;
      &lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;box-sizing&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; border-box&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; relative&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; flex&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;flex-direction&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; column&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;align-items&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; stretch&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;flex-shrink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;align-content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; flex-start&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;justify-content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; flex-start&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token property&quot;&gt;border&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0 solid black&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;margin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;min-width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;flex 是預設的，所有呈現都是 flexbox。只是預設值是&lt;code class=&quot;language-text&quot;&gt;flex: 0&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;上面的每個元素都是&lt;code class=&quot;language-text&quot;&gt;position: relative&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;額外說明: flex 數字意義&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;註: flex 通常是&lt;code class=&quot;language-text&quot;&gt;flex: 1&lt;/code&gt;。這與 CSS3 中的 flex 定義方式不同。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;只能使用一個數字。(flex ReactPropTypes.number)&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;正數&lt;/strong&gt;代表元件是有”彈性的”，會隨著尺寸等比例放大，例如設為 2 的元件佔的大小是 1 的兩倍。類似於&lt;code class=&quot;language-text&quot;&gt;flexGrow&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;當為&lt;strong&gt;0&lt;/strong&gt;時，代表元件沒有彈性，只是對應所設置的寬與高度。&lt;/p&gt;
&lt;p&gt;當為&lt;strong&gt;-1&lt;/strong&gt;時，代表元件一般情況對應所設置的寬與高度，當空間不足時會縮小(shrink)到 minWidth 與 minHeight。類似於&lt;code class=&quot;language-text&quot;&gt;flexShrink&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;如果你想要某個元件佔 25%，另一個元件佔 75%，就用&lt;code class=&quot;language-text&quot;&gt;flex: 1/4&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;flex: 3/4&lt;/code&gt;分別指定兩個元件。&lt;/p&gt;
&lt;h3&gt;額外說明: alignItems&lt;/h3&gt;
&lt;p&gt;alignItems 要有作用(stretch，填好填滿)，子元素必須沒有設定對應 cross axis(相反基準線)的寬度(或高度)才會有作用。&lt;/p&gt;
&lt;h3&gt;小抄&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;最前面一個值為 RN 預設值&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;# Choose the main axis:
flexDirection: &amp;#39;column&amp;#39; || &amp;#39;row&amp;#39;

# Align the main axis:
justifyContent: &amp;#39;flex-start&amp;#39; || &amp;#39;flex-end&amp;#39; || &amp;#39;center&amp;#39; || &amp;#39;space-around&amp;#39; || &amp;#39;space-between&amp;#39;

# Align the cross axis:
alignItems: &amp;#39;stretch&amp;#39; || &amp;#39;flex-start&amp;#39; || &amp;#39;flex-end&amp;#39; || &amp;#39;center&amp;#39;

# Align individual elements:
alignSelf: &amp;#39;flex-start&amp;#39; || &amp;#39;flex-end&amp;#39; || &amp;#39;center&amp;#39; || &amp;#39;stretch&amp;#39; || &amp;#39;auto&amp;#39;

# Give it a wrap:
flexWrap: &amp;#39;nowrap&amp;#39; || &amp;#39;wrap&amp;#39;

# Define relative fluidity of an element:
flex: number (e.g. 1, 1/2)&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;議題&lt;/h2&gt;
&lt;h3&gt;全寬度 &amp;#x26; 全高度&lt;/h3&gt;
&lt;p&gt;方法一: 用 alignSelf: “stretch”可以設定某個元件用全寬度或全高度:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;line1&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    backgroundColor&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;#FDD7E4&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    alignSelf&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;stretch&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    textAlign&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;center&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;方法二: 用 Dimensions 可以獲得，不一定得要用 flex 來設定:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  AppRegistry&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;
  Dimensions
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; React&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; width &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dimensions&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;window&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;width&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//full width&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; height &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Dimensions&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;get&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;window&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;height&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//full height&lt;/span&gt;


line1&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    backgroundColor&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;#FDD7E4&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    width&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;一些密訣&lt;/h2&gt;
&lt;p&gt;If the element has a parent container, child element can be positioned with Flex item property — &lt;code class=&quot;language-text&quot;&gt;align-self&lt;/code&gt; inside parent container still being Flex container, behaving and accepting Flex container properties.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Flex container children always follows parent container Main Axis direction&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Hint: to prevent expanding full width after declaring flex: 1, use maxWidth/maxHeight property.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2&gt;狀態列高度&lt;/h2&gt;
&lt;p&gt;由於目前手機都有狀態列在最上面(垂直排列時)，使用 expo 所提供的常數 Constants.statusBarHeight 可以取得這個高度，範例如下:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; React&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Component &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; View&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; StyleSheet &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react-native&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Constants &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;expo&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; Button &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react-native-elements&apos;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;@expo/vector-icons&apos;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;App&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Component&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;View style&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;styles&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;container&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
        &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Button title&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Yea&quot;&lt;/span&gt; containerViewStyle&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; width&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;100%&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; marginLeft&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
      &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;View&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; styles &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; StyleSheet&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  container&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    flex&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    justifyContent&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;center&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    paddingTop&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Constants&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;statusBarHeight&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    backgroundColor&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;#ecf0f1&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;flex vs flexGrow vs flexShrink vs flexBasis in React Native?&lt;/h2&gt;
&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/43143258/flex-vs-flexgrow-vs-flexshrink-vs-flexbasis-in-react-native&quot;&gt;https://stackoverflow.com/questions/43143258/flex-vs-flexgrow-vs-flexshrink-vs-flexbasis-in-react-native&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[理解ES6中的暫時死區(TDZ)]]></title><link>https://eddychang.me/es6-tdz/</link><guid isPermaLink="false">https://eddychang.me/es6-tdz/</guid><content:encoded>&lt;p&gt;Temporal Dead Zone(TDZ)是 ES6(ES2015)中對作用域新的專用語義。TDZ 名詞並沒有明確地寫在 ES6 的標準文件中，一開始是出現在&lt;a href=&quot;https://esdiscuss.org/&quot;&gt;ES Discussion&lt;/a&gt;討論區中，是對於某些遇到在區塊作用域綁定早於宣告語句時的狀況時，所使用的專用術語。&lt;/p&gt;
&lt;p&gt;以英文名詞來說明，Temporal 是”時間的、暫時的”意義，Dead Zone 則是”死區”，意指”電波達不到的區域”。所以 TDZ 可以翻為”時間上暫時的無法達到的區域”，簡稱為”時間死區”或”暫時死區”。&lt;/p&gt;
&lt;h2&gt;let/const 與 var&lt;/h2&gt;
&lt;p&gt;在 ES6 的新特性中，最容易看到 TDZ 作用就是在 let/const 的使用上，let/const 與 var 的主要不同有兩個地方:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;let/const 是使用區塊作用域；var 是使用函式作用域&lt;/li&gt;
&lt;li&gt;在 let/const 宣告之前就存取對應的變數與常數，會拋出&lt;code class=&quot;language-text&quot;&gt;ReferenceError&lt;/code&gt;錯誤；但在 var 宣告之前就存取對應的變數，則會得到&lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;aVar&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// undefined&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;aLet&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// causes ReferenceError: aLet is not defined&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; aVar &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; aLet &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;根據 ES6 標準中對於 let/const 宣告的章節&lt;a href=&quot;http://www.ecma-international.org/ecma-262/6.0/#sec-let-and-const-declarations&quot;&gt;13.3.1&lt;/a&gt;，有以下的文字說明:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;The variables are created when their containing Lexical Environment
 is instantiated but may not be accessed in any way until the
 variable’s LexicalBinding is evaluated.&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;意思是說由 let/const 宣告的變數，當它們包含的詞法環境(Lexical Environment)被實體化時會被建立，但只有在變數的詞法綁定(LexicalBinding)已經被求值運算後，才能夠被存取。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 這裡指的”變數”是 let/const 兩者，const 在 ES6 定義中是 constant variable(固定的變數)的意思。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;說得更明白些，當程式的控制流程在新的作用域(module, function 或 block 作用域)進行實體化時，在此作用域中的用 let/const 宣告的變數會先在作用域中被建立出來，但因此時還未進行詞法綁定，也就是對宣告語句進行求值運算，所以是不能被存取的，存取就會拋出錯誤。所以在這執行流程一進入作用域建立變數，到變數開始可被存取之間的一段時間，就稱之為 TDZ(暫時死區)。&lt;/p&gt;
&lt;p&gt;以上面解說來看，以 let/const 宣告的變數，的確也是有提升(hoist)的作用。這個是很容易被誤解的地方，實際上以 let/const 宣告的變數也是會有提升(hoist)的作用。提升是 JS 語言中對於變數宣告的基本特性，只是因為 TDZ 的作用，並不會像使用 var 來宣告變數，只是會得到&lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;而已，現在則是會直接拋出&lt;code class=&quot;language-text&quot;&gt;ReferenceError&lt;/code&gt;錯誤，而且很明顯的這是一個在執行期間才會出現的錯誤。&lt;/p&gt;
&lt;p&gt;用一個簡單的範例來說明 let 宣告的變數會在作用域中被提升，就像下面這樣:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;outer value&apos;&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// 這裡會產生 TDZ for x&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// TDZ期間存取，產生ReferenceError錯誤&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;inner value&apos;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 對x的宣告語句，這裡結束 TDZ for x&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;在範例中的 IIFE 裡的函式作用域，變數 x 在作用域中會先被提升到函式區域中的最上面，但這時會產生 TDZ，如果在程式流程還未執行到 x 的宣告語句時，算是在 TDZ 作用的期間，這時候存取 x 的值，就會拋出&lt;code class=&quot;language-text&quot;&gt;ReferenceError&lt;/code&gt;錯誤。&lt;/p&gt;
&lt;p&gt;在 let 與 const 宣告的章節&lt;a href=&quot;http://www.ecma-international.org/ecma-262/6.0/#sec-let-and-const-declarations&quot;&gt;13.3.1&lt;/a&gt;接著的幾句，說明有關變數是如何進行初始化的:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;A variable defined by a LexicalBinding with an Initializer is
assigned the value of its Initializer’s AssignmentExpression when
 the LexicalBinding is evaluated, not when the variable is created.
 If a LexicalBinding in a let declaration does not have an
 Initializer the variable is assigned the value undefined when the
 LexicalBinding is evaluated.&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;這幾句比較重點的部份是關於初始化的過程。以 let/const 宣告的變數或常數，必需是經過對宣告的指定值語句的求值後，才算初始化完成，建立時並不算初始化。如果以 let 宣告的變數沒有指定給初始值，那麼就指定值給它&lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;值。也就是經過初始化的完成，才代表著 TDZ 期間的真正結束，這些在作用域中的被宣告的變數才能夠正常地被存取。&lt;/p&gt;
&lt;p&gt;下面這個範例是一個未初始化完成的結果，它一樣是在 TDZ 中，也是會拋出&lt;code class=&quot;language-text&quot;&gt;ReferenceError&lt;/code&gt;錯誤:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; x&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;因為右值(要被指定的值)，它在此時是一個還未被初始化完成的變數，實際上我們就在這一個同一表格達式中要初始化它。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;註: TDZ 最一開始是為了 const 所設計的，但後來的對 let 的設計也是一致的，範例中都用 let 來說明會比較容易。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 在 ES6 標準中，對於 const 所宣告的識別子仍然也經常為 variable(變數)，稱為 constant variable(固定的變數)。以 const 宣告所建立出來的常數，在 JS 中只是不能再被指定(can’t re-assignment)，並不是不可被改變(immutable)的，這兩種概念仍然有很大的差異。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;函式的傳入參數預設值&lt;/h2&gt;
&lt;p&gt;TDZ 作用在 ES6 中，很明確的就是與區塊作用域(block scope)，以及變數/常數的要如何被初始化有關。實際上在許多 ES6 新特性中都有出現 TDZ 作用，而另一個常會被提及的是函式的傳入參數預設值中的 TDZ 作用。&lt;/p&gt;
&lt;p&gt;下面的範例可以看到在傳入參數預設值的識別名稱，在未經初始化(有指定到值)時，它會進入 TDZ 而產生錯誤，而這個錯誤是只有在函式呼叫時，要使用到傳入參數預設值時才會出現:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; y &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 這不會有錯誤&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;undefined&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 錯誤 ReferenceError: y is not defined&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// 錯誤 ReferenceError: y is not defined&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;從這個範例可以知道 TDZ 的作用，實際上在 ES6 中到處都有類似的作用。&lt;/p&gt;
&lt;p&gt;傳入參數預設值有另一個作用域的議題會被討論，就是對於傳入參數預設值的作用域，到底是屬於”全域作用域”還是”函式中的作用域”的議題，目前看到比較常見的說法是，它是處於”中介的作用域”，夾在這兩者之間，但仍然會互相影響。中介的作用域的一個範例，是使用其他函式作為傳入參數的預設值，這通常會是一個 callback(回調、回呼)函式，一般的情況沒什麼特別，但涉及作用域時互相影響的情況下會不易理解。下面這個範例&lt;a href=&quot;http://dmitrysoshnikov.com/ecmascript/es6-notes-default-values-of-parameters/#conditional-intermediate-scope-for-parameters&quot;&gt;來自這裡&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  a &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token function-variable function&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;這個範例中的最後結果，在函式 foo 中輸出的 x 值到底是 1、2 還是 3？另外，在最外圍作用域的 x 最後會被改變嗎？&lt;/p&gt;
&lt;p&gt;函式中的 x 輸出結果不可能是 1，這是很明確的，因為函式區塊中有另一個 x 的宣告與指定值&lt;code class=&quot;language-text&quot;&gt;let x = 3&lt;/code&gt;語句，這兩個都有可能被執行產生作用。剩下的是傳入參數預設值中的那個函式，是不是會變數到函式區塊中的 x 值的問題。另一個是，在全域中的那個 x 變數，會不會被改變，這也是一個問題。&lt;/p&gt;
&lt;p&gt;按照這個範例的出處文章的說明，作者認為答案是 3 與 1。但是根據我的實驗，下面的幾個瀏覽器與編譯器並不是這樣認為:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;babel 編譯器: 2 與 1&lt;/li&gt;
&lt;li&gt;Closure Compiler: 3 與 2&lt;/li&gt;
&lt;li&gt;Google Chrome(v55): 3 與 2&lt;/li&gt;
&lt;li&gt;Firefox(v50): 2 與 1&lt;/li&gt;
&lt;li&gt;Edge(v38): 3 與 2&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;實際測試的結果，怎麼都不會有 3 與 1 的答案，要不就 3 與 2，要不就 2 與 1。&lt;/p&gt;
&lt;p&gt;3 與 2 的答案是讓 b 傳入參數的&lt;code class=&quot;language-text&quot;&gt;x = 2&lt;/code&gt;執行出來，但因為受到中介作用域的影響，因此干擾不到函式中的原本區塊中的作用域，但會影響到全域中的 x 變數。也就是基本上認定函式預設值中的那個 callback 中的作用域與全域(或外層)有關系。&lt;/p&gt;
&lt;p&gt;2 與 1 的答案則是倒過來，只會影響到函式中的區塊，對全域(或外層)沒有影響。&lt;/p&gt;
&lt;p&gt;所以除非中介作用域，有自己獨立的作用域，完全與函式區塊中的作用域與全域都不相干，才有可能產生 3 與 1 的結果，這是這篇文章的作者所認為的。&lt;/p&gt;
&lt;p&gt;這個函式預設值的作用域因為實作不同，造成兩種不同的結果，但如果以 Chrome(v55)與 Firefox(v50)來實驗，在 TDZ 期間的拋出錯誤的行為基本上會一致，但 Firefox 有兩種不同的錯誤訊息，例如下面的幾個範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Chrome: ReferenceError: x is not defined&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Firefox: ReferenceError: x is not defined&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  a &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token function-variable function&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Chrome: ReferenceError: x is not defined&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Firefox: ReferenceError: can&apos;t access lexical declaration `x&apos; before initialization&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  a &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token function-variable function&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// Chrome: ReferenceError: x is not defined&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Firefox: ReferenceError: can&apos;t access lexical declaration `x&apos; before initialization&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  a &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token function-variable function&quot;&gt;b&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;b&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;foo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;不管如何，這個作用域的影響仍然是有爭議的，目前並沒有統一的答案。這代表格 ES6 雖然標準定好了，但裡面的一些新特性仍然有實作細節的差異，未來有可能這些差異才會慢慢一致。但對一般的開發者來說，因為知道了有這些情況，所以要盡量避免，以免產生不相容的情況。&lt;/p&gt;
&lt;p&gt;要如何避免這種情況？最重要的就是，“不要在傳入參數預設值中作有副作用的運算”，上面的&lt;code class=&quot;language-text&quot;&gt;function(){ x = 2 }&lt;/code&gt;是有副作用的，它有可能會改變函式區塊中，或是全域中的同名稱變數，而在整個程式碼中，可能會互相影響的作用域彼此之間，避免使用同樣識別名稱的變數，這也是一個很基本的撰寫規則。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 本節的內容可以參考這幾篇文章&lt;a href=&quot;http://jsrocks.org/2015/01/temporal-dead-zone-tdz-demystified/&quot;&gt;TEMPORAL DEAD ZONE (TDZ) DEMYSTIFIED&lt;/a&gt;、&lt;a href=&quot;http://dmitrysoshnikov.com/ecmascript/es6-notes-default-values-of-parameters/#tdz-temporal-dead-zone-for-parameters&quot;&gt;ES6 Notes: Default values of parameters&lt;/a&gt;與這個&lt;a href=&quot;https://github.com/google/traceur-compiler/issues/1376&quot;&gt;Default parameters intermediate scope&lt;/a&gt;討論文。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;TDZ 的其它議題(陷阱)&lt;/h2&gt;
&lt;h3&gt;typeof 語句&lt;/h3&gt;
&lt;p&gt;對 TDZ 期間中的變數/常數作任何的存取動作，一律會拋出錯誤，使用&lt;code class=&quot;language-text&quot;&gt;typeof&lt;/code&gt;的語句也一樣。如下面的範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;typeof&lt;/span&gt; x &lt;span class=&quot;token comment&quot;&gt;// &quot;undefined&quot;&lt;/span&gt;

&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// TDZ&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;typeof&lt;/span&gt; x &lt;span class=&quot;token comment&quot;&gt;// ReferenceError&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;但有些開發者會認為像&lt;code class=&quot;language-text&quot;&gt;typeof&lt;/code&gt;這樣的語句，需要被用來判斷變數是否存在，不應該是導致拋出錯誤，所以有部份反對的聲音，認為它讓&lt;code class=&quot;language-text&quot;&gt;typeof&lt;/code&gt;語句變得不安全，會造成使用上的陷阱。實際上這原本就是 TDZ 的設計，變數本來就不該在沒宣告完成前存取，這是為了讓 JS 執行更為合理的改善設計，只是之前 JS 在這一部份是有缺陷的作法，實際上會用&lt;code class=&quot;language-text&quot;&gt;typeof&lt;/code&gt;與 undefined 來判別變數/常數存在與否的方式，通常是對於全域變數的才會作的事情。&lt;/p&gt;
&lt;h3&gt;TDZ 期間拋出的錯誤是執行階段的錯誤&lt;/h3&gt;
&lt;p&gt;TDZ 期間所拋出的錯誤，是一種執行階段的錯誤，因為 TDZ 除了作用域的綁定過程外，還需要有變數/常數初始化的過程，才會建立出 TDZ 的期間。下面兩個範例就可以看到 TDZ 的錯誤需要真正執行到才會出現:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// 這個範例會有因TDZ拋出的錯誤&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; x
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// ReferenceError&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// 這個範例不會有錯誤&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;f&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; x
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;那這會有什麼問題出現？因為要能偵測出程式碼中的因 TDZ 造成的錯誤，唯有透過靜態的程式碼分析工具，或是要真正呼叫到函式執行裡面的程式碼，才會產生錯誤，這將會讓 TDZ 在編譯工具中實作變得困難。&lt;/p&gt;
&lt;p&gt;不過只要你理解 TDZ 的設計，就知道只能這樣設計，初始化過程原本就只會在呼叫執行階段作這事，這部份還是只能靠其它工具來補強。&lt;/p&gt;
&lt;h3&gt;支援 ES6 的瀏覽器上的執行效能&lt;/h3&gt;
&lt;p&gt;在&lt;a href=&quot;https://esdiscuss.org/topic/performance-concern-with-let-const&quot;&gt;ES Discussion&lt;/a&gt;上對於 let/const 的效能很早以前就已經有些批評的，認為在瀏覽器上實作的結果，由於 TDZ 的設計，會讓 let 相較於 var 的效能至少要慢 5%。&lt;/p&gt;
&lt;p&gt;上面這篇貼文是在 4 年前所發表，就算是當時的實驗性質的實作在 JS 引擎上，沒有經過最佳化，實際上真的效能有差這麼大也不得而知。加上 let 本身在 for 回圈上有另外的花費，與 var 的設計不同，這兩個比較當然會有所不同，是不是都是 TDZ 影響的也不知道。&lt;/p&gt;
&lt;p&gt;以最近在討論區中的&lt;a href=&quot;http://stackoverflow.com/questions/21467642/is-there-a-performance-difference-between-let-and-var&quot;&gt;let 與 var 的效能&lt;/a&gt;比較議題來看，let 的執行效率只有在某些情況下(for 回圈中)會慢 var 很多，在基本的內部作用域測試反而是快過 var 的，當然這也是要視不同的瀏覽器與版本而定。&lt;/p&gt;
&lt;p&gt;題外話是，在其它的回答中就有明確的指出，會促使加入 TDZ 的主因是針對 const，而不是 let。但最後 TC39 的決議是讓 let 與 const 都有一致的 TDZ 設計。&lt;/p&gt;
&lt;h3&gt;ES6 到 ES5 的編譯&lt;/h3&gt;
&lt;p&gt;ES6 中的許多新式的設計仍然是很新的 JS 語言特性，目前 ES6 仍然需要依賴如 babel 之類別的編譯器，將 ES6 語法編譯到 ES5，來進行在瀏覽器上執行前的最後編譯。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;這些編譯器對於 TDZ 是會如何編譯？答案是目前”並不會直接編譯”。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;以 babel 來說，它預設不會編譯出具有 TDZ 的程式碼，它需要額外使用&lt;a href=&quot;https://babeljs.io/docs/plugins/transform-es2015-block-scoping/&quot;&gt;babel-plugin-transform-es2015-block-scoping&lt;/a&gt;或編譯時的選項&lt;code class=&quot;language-text&quot;&gt;es6.blockScopingTDZ&lt;/code&gt;，才會將 TDZ 與區域作用域的功能編譯出來。基本上這應該屬於實驗性質的，而且現在在使用上還有滿多問題的。ES5 標準中原本就沒這種設計，所以說實在硬要使用也是麻煩，TDZ 會造成的錯誤是執行期間的錯誤，對於編譯器來說，在實作上也有一定的難度。&lt;/p&gt;</content:encoded></item><item><title><![CDATA[JS中的關係比較與相等比較運算]]></title><link>https://eddychang.me/js-relational-comparison/</link><guid isPermaLink="false">https://eddychang.me/js-relational-comparison/</guid><content:encoded>&lt;p&gt;在 JS 中的關係比較(Relational Comparison)運算，指的是像&lt;code class=&quot;language-text&quot;&gt;x &amp;lt; y&lt;/code&gt;這種大小值的關係比較。&lt;/p&gt;
&lt;p&gt;而相等比較，可區分為標準相等(standard equality)比較&lt;code class=&quot;language-text&quot;&gt;x == y&lt;/code&gt;與嚴格相等(strict equality)比較&lt;code class=&quot;language-text&quot;&gt;x === y&lt;/code&gt;兩大種類。嚴格相等比較會比較左邊與右邊運算元的資料類型，值相等比較則只看值，簡單的來說是這樣解釋沒錯。&lt;/p&gt;
&lt;p&gt;ToPrimitive 運算的詳細說明可參考: &lt;a href=&quot;../js-object-plus-object/&quot;&gt;JS 中的{} + {}與{} + []的結果是什麼？&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;不過，這兩種比較實際上依內部設計來說，並不是那麼簡單。當然，在一般的使用情況是不需要考量那麼多，本文的說明會涉及許多 JS 內部設計的部份，對於這兩種比較來作比較徹底的理解，主要的參考資料是 ECMAScript 的標準文件。&lt;/p&gt;
&lt;h2&gt;嚴格相等比較(嚴格相等比較演算)&lt;/h2&gt;
&lt;p&gt;嚴格相等比較的演算規則先理解，主要是因為在標準相等比較(只比較值不比較資料類型)時，它在演算時的某些情況下會跳到嚴格相等比較的規則來。&lt;/p&gt;
&lt;p&gt;嚴格相等比較的演算規則很容易理解，按照以下的步驟進行比較，出自&lt;a href=&quot;http://www.ecma-international.org/ecma-262/5.1/#sec-11.9.6&quot;&gt;ecma-262 11.9.6&lt;/a&gt;:&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;以下假設為比較 &lt;code class=&quot;language-text&quot;&gt;x === y&lt;/code&gt;的情況，Type(x)指的是 x 的資料類型，Type(y)指的是 y 的類型，最終回傳值只有 true 或 false，會按照下面的步驟進行比較，如果有回傳時就停止之後的步驟:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;註: Type(x)在 ECMAScript 的標準中指的並不是用&lt;code class=&quot;language-text&quot;&gt;typeof&lt;/code&gt;回傳出來的結果，而是標準內部給定的各種資料類型，共有 Undefined, Null, Boolean, String, Number 與 Object。例如&lt;code class=&quot;language-text&quot;&gt;typeof null&lt;/code&gt;的結果是”object”，但 ECMAScript 會認為 Null 是個獨立的資料類型。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Type(x)與 Type(y)不同，回傳 false&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Type(x)是 Undefined，回傳 true(當然此時 Type(y)也是 Undefined)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Type(x)是 Null，回傳 true(當然此時 Type(y)也是 Null)&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Type(x)是 Number 時&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;a. x 是 NaN，回傳 false&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;b. y 是 NaN，回傳 false&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;c. x 與 y 是同樣的數字，回傳 true&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;d. x 是+0，y 是-0，回傳 true&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;e. x 是-0，y 是+0，回傳 true&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;f. 其他情況，回傳 false&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Type(x)是 String 時，只有當 x 中的字元順序與 y 中完全相同時(長度相同，字元所在位置也相同)，回傳 true。其他情況就回傳 false。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Type(x)是 Boolean 時，只有當 x 與 y 是同時為 true 或同時為 false 時，回傳 true。其它情況回傳 false。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;只有當 x 與 y 同時參照到同一物件時，回傳 true。其它情況回傳 false。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;備註: 這個演算與 the SameValue Algorithm (9.12)不同之處在於，對於有號的 0 與 NaN 處理方式不同。&lt;/p&gt;
&lt;hr&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 同值演算(the SameValue Algorithm)是標準中的另一個內部演算法，只會用在很特別的地方，可以先略過不看。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;從上述的嚴格相等比較中，可以很清楚的看到數字、字串、布林與 null、undefined 或物件是如何比較的。&lt;/p&gt;
&lt;h2&gt;標準相等比較(抽象相等比較演算)&lt;/h2&gt;
&lt;p&gt;標準相等比較的演算規則按照以下的步驟進行比較，出自&lt;a href=&quot;http://www.ecma-international.org/ecma-262/5.1/#sec-11.9.3&quot;&gt;ecma-262 11.9.3&lt;/a&gt;:&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;以下假設為比較 &lt;code class=&quot;language-text&quot;&gt;x == y&lt;/code&gt;的情況，Type(x)指的是 x 的資料類型，Type(y)指的是 y 的類型，最終回傳值只有 true 或 false，會按照下面的步驟進行比較，如果有回傳時就停止之後的步驟:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Type(x)與 Type(y)相同時，進行嚴格相等比較&lt;/li&gt;
&lt;li&gt;x 是 undefined，而 y 是 null 時，回傳 true&lt;/li&gt;
&lt;li&gt;x 是 null，而 y 是 undefined 時，回傳 true&lt;/li&gt;
&lt;li&gt;Type(x)是 Number 而 Type(y)是 String 時，進行&lt;code class=&quot;language-text&quot;&gt;x == ToNumber(y)&lt;/code&gt;比較&lt;/li&gt;
&lt;li&gt;Type(x)是 String 而 Type(y)是 Number 時，進行&lt;code class=&quot;language-text&quot;&gt;ToNumber(x) == y&lt;/code&gt;比較&lt;/li&gt;
&lt;li&gt;Type(x)是 Boolean 時，進行&lt;code class=&quot;language-text&quot;&gt;ToNumber(x) == y&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Type(y)是 Boolean 時，進行&lt;code class=&quot;language-text&quot;&gt;x == ToNumber(y)&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Type(x)是 Number 或 String 其中一種，而 Type(y)是個 Object 時，進行&lt;code class=&quot;language-text&quot;&gt;x == ToPrimitive(y)&lt;/code&gt;比較&lt;/li&gt;
&lt;li&gt;Type(x)是個 Object，而 Type(y)是 Number 或 String 其中一種時，進行&lt;code class=&quot;language-text&quot;&gt;ToPrimitive(x) == y&lt;/code&gt;比較&lt;/li&gt;
&lt;li&gt;其他情況，回傳 false&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;備註 1: 以下的是三種強制轉換的標準比較情況:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;字串比較: &quot;&quot; + a == &quot;&quot; + b.&lt;/li&gt;
&lt;li&gt;數字比較: +a == +b.&lt;/li&gt;
&lt;li&gt;布林比較: !a == !b&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;備註 2: 標準相等比較有以下的不變式(invariants):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;A != B 相當於 !(A == B)&lt;/li&gt;
&lt;li&gt;A == B 相當於 B == A&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;備註 3: 相等比較運算不一定總是可以轉變(transitive)，例如:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;new String(“a”) == “a” 與 “a” == new String(“a”) 的結果都是 true&lt;/li&gt;
&lt;li&gt;new String(“a”) == new String(“a”) 結果是 false.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;備註 4: 字串比較使用的是簡單的字元測試。並非使用複雜的、語義導向的字元定義或是 Unicode 所定義的字串相等或校對順序。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 上述的 ToNumber 與 ToPrimitive 都是標準內部運算時使用的方法，並不是讓開發者使用的。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;由標準相等比較的演算得知，它的運算是以”數字為最優先”，任何其它的類型如果與數字作相等比較，必定要先強制轉為數字再比較。但這是一個相當具有隱藏作用的運算，在一般實作時，會很容易造成誤解，例如以下的範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;上面這是因為空陣列&lt;code class=&quot;language-text&quot;&gt;[]&lt;/code&gt;，進行&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;運算後，得到的是空字串，所以作值相等比較，相當於空字串在進行比較。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;[object Object]&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;NaN&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;上面的空物件字面量，進行&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;運算後，得到的是&lt;code class=&quot;language-text&quot;&gt;&amp;#39;[object Object]&amp;#39;&lt;/code&gt;字串，這個值會如果與數字類型的 NaN 比較，會跳到同類型相等的嚴格相等比較中，NaN 不論與任何數字作相等比較，一定是回傳 false。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;Number&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;上面說明了，包裝物件在 JS 中的內部設計中，標準的值相等比較是相同的，但嚴格相等比較是不同的值，包裝物件仍然是個物件，只是裡面的 valueOf 方法是回傳這個物件裡面帶的原始資料類型值，經過&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;方法運算後，會回傳原始資料的值。&lt;code class=&quot;language-text&quot;&gt;Number()&lt;/code&gt;函式呼叫只是轉數字類型用的函式，這個用法經常會與包裝物件的用法混在一起。&lt;/p&gt;
&lt;p&gt;這個小節的結論是，在 JS 中沒有必要的情況下，使用嚴格的相等比較為最佳值比較方式，標準的相等比較容易產生不經意的副作用，有的時候你可能會得到不預期的結果。&lt;/p&gt;
&lt;h2&gt;關係比較(抽象關係比較演算)&lt;/h2&gt;
&lt;p&gt;關係比較的演算規則主要是按照以下的步驟進行比較，出自&lt;a href=&quot;http://www.ecma-international.org/ecma-262/5.1/#sec-11.8.5&quot;&gt;ecma-262 11.8.5&lt;/a&gt;:&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;以下假設為比較 &lt;code class=&quot;language-text&quot;&gt;x &amp;lt; y&lt;/code&gt;的情況，因為在標準中的抽象關係比較演算的說明比較複雜，有涉及布林標記的以左方優先或右方優先，而且最終回傳值有 true、false 與 undefined，實際上最終不會有 undefined 值出現，即是得到&lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt;而已，以下為只考慮左方優先(LeftFirst)的簡化過的步驟。會按照下面的步驟進行比較，如果有回傳時就停止之後的步驟:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;(1. &amp;#x26; 2.) x 經過 ToPrimitive(x, hint Number)運算為 px 值，y 經過 ToPrimitive(y, hint Number)運算為 py 值&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(3.) 如果 Type(px)與 Type(py)不同時為 String 時&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a.b. px 作 ToNumber(px)運算，得到 nx 值，與 py 作 ToNumber(py)值，得到 ny 值&lt;/li&gt;
&lt;li&gt;c.d. nx 或 ny 中有其一為 NaN 時，回傳 undefined&lt;/li&gt;
&lt;li&gt;e. nx 與 ny 是同樣的 Number 值，回傳 false&lt;/li&gt;
&lt;li&gt;f. nx 是+0，而且 ny 是 −0，回傳 false&lt;/li&gt;
&lt;li&gt;g. nx 是 −0，而且 ny 是+0，回傳 false.&lt;/li&gt;
&lt;li&gt;h. nx 是+∞，回傳 false&lt;/li&gt;
&lt;li&gt;i. ny 是+∞，回傳 true&lt;/li&gt;
&lt;li&gt;j. ny 是 −∞，回傳 false&lt;/li&gt;
&lt;li&gt;k. nx 是 −∞，回傳 true&lt;/li&gt;
&lt;li&gt;l. 如果在數學上的值，nx 小於 ny，而且 nx 與 ny 是有限值(finite)，而且不同時為 0 時，回傳 true。否則回傳 false。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;(4.) 如果 Type(px)與 Type(py)同時為 String 時&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;a. 如果 py 是 px 的前綴(prefix)時，回傳 false (前綴代表 px 字串中是由 py 字串組成的，py 只是 px 的子字串的情況)&lt;/li&gt;
&lt;li&gt;b. 如果 px 是 py 的前綴(prefix)時，回傳 true&lt;/li&gt;
&lt;li&gt;c.d.e.f 以字串中的按順序的字元，用字元的編碼整數的大小來比較。k 是可得到的一個最小非負整數，在 px 與 py 中的 k 位置有不同的字元(從左邊算過來)。在 px 中某個位置 k 的字元編碼整數為 m，在 py 某個位置 k 的字元編輯為 n，如果 m &amp;#x3C; n，則回傳 true，否則回傳 false&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;備註 2: 字串比較使用的是簡單的詞典順序測試。並非使用複雜的、語義導向的字元定義或是 Unicode 所定義的字串相等或校對順序。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;註: &lt;code class=&quot;language-text&quot;&gt;+∞&lt;/code&gt;相當於全域屬性&lt;code class=&quot;language-text&quot;&gt;Infinity&lt;/code&gt;或&lt;code class=&quot;language-text&quot;&gt;Number.POSITIVE_INFINITY&lt;/code&gt;，&lt;code class=&quot;language-text&quot;&gt;−∞&lt;/code&gt;相當於全域屬性&lt;code class=&quot;language-text&quot;&gt;-Infinity&lt;/code&gt;或&lt;code class=&quot;language-text&quot;&gt;Number.NEGATIVE_INFINITY&lt;/code&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr&gt;
&lt;p&gt;關係比較基本上要區分為數字類型與字串類型，但依然是以”數字”為最優先的比較，只要有其他類型與數字相比較，一定會先被強制轉換為數字。但在這之前，需要先用&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;而且是 hint 為數字來轉換為原始資料類型。&lt;/p&gt;
&lt;p&gt;以下為一些與物件、陣列、Date 物件的關係比較範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;雖然在標準中的抽象關係比較演算中，有存在一種回傳值&lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;，但在真實的情況並沒有這種回傳值，相當不論怎麼比較都是得到&lt;code class=&quot;language-text&quot;&gt;false&lt;/code&gt;的值。上面的例子中，空物件({})的 ToPrimitive 運算得出的是&lt;code class=&quot;language-text&quot;&gt;&amp;#39;[object Object]&amp;#39;&lt;/code&gt;字串值，經過&lt;code class=&quot;language-text&quot;&gt;ToNumber&lt;/code&gt;運算會得到 NaN 數字類型的值，這個值不論與數字 1 作大於小於的關係運算，都是 false。&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Date()&lt;/code&gt;物件因為&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;運算的 hint 為數字，所以也是會作轉換為數字類型的值為優先(也就是呼叫 valueOf 為優先)，所以並不是正常情況的以輸出字串為優先(也就是呼叫 toString 方法為優先)的預設情況。&lt;/p&gt;
&lt;p&gt;以下為一些字串關係比較的範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;a&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;字串與空字串相比，都是套用前綴(prefix)的規則步驟，因為空字串算是所有字串的前綴(組成的子字串之一)，所以必然地所有有值的字串值一定是大於空字串。&lt;/p&gt;
&lt;p&gt;空陣列經過 ToPrimitive 運算出來的是空字串，所以與空字串相比較的結果相同。&lt;/p&gt;
&lt;p&gt;空物件經過 ToPrimitive 運算出來的是&lt;code class=&quot;language-text&quot;&gt;&amp;#39;[object Object]&amp;#39;&lt;/code&gt;字串值，以&lt;code class=&quot;language-text&quot;&gt;&amp;#39;a&amp;#39;.charCodeAt(0)&lt;/code&gt;計算出的值是字元編碼是 97 數字，而&lt;code class=&quot;language-text&quot;&gt;&amp;#39;[&amp;#39;.charCodeAt(0)&lt;/code&gt;則是 91 數字，所以&lt;code class=&quot;language-text&quot;&gt;&amp;#39;a&amp;#39; &amp;gt; ({})&lt;/code&gt;會是得到 true。&lt;/p&gt;
&lt;p&gt;如果開始混用數字與字串比較，可能是有陷阱的比較例子:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;11&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;3&apos;&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;11&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;one&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;one&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;‘11’與’3’相比較，其實都是字串比較，要依照可比較的字元位置來比較，也就是’1’與’3’字元的比較，它們的字元編碼數字分別是 49 與 51，所以&lt;code class=&quot;language-text&quot;&gt;&amp;#39;1&amp;#39; &amp;lt; &amp;#39;3&amp;#39;&lt;/code&gt;，這裡的運算的結果必然是回傳 false。&lt;/p&gt;
&lt;p&gt;‘11’與 3 數字比較，是會強制都轉為數字來比較，‘11’會轉為 11 數字值，所以大於 3。&lt;/p&gt;
&lt;p&gt;‘one’這個字串轉為數字後，是 NaN 這個數字值，NaN 與任何數字比較，既不大於也不小於，不論作大於或小於，都是回傳 false。(實際上在標準中它這種回傳值叫 undefined)&lt;/p&gt;
&lt;p&gt;字串與數字之外其他的原始資料類型的比較，只要記得原則就是強制轉為數字來比較就是了，以下為例子:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; undefined
&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;簡單地說明在 ToNumber 運算時，這些其他的原始資料類型值的轉換結果如下:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Undefined -&gt; NaN&lt;/li&gt;
&lt;li&gt;Null -&gt; +0&lt;/li&gt;
&lt;li&gt;Boolean -&gt; (true -&gt; 1, false -&gt; 0)&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;註: JS 認為+0 與-0 是完全相同的值，在嚴格相等比較中是相等的。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 字串比較實際上是拆為字元在詞典表中的編輯整數值來比較，對於非英語系的語言，JS 另外有提供&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/localeCompare&quot;&gt;String.prototype.localeCompare&lt;/a&gt;的方法來進行本地語言的比較工作。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;總結&lt;/h2&gt;
&lt;p&gt;本章延伸了之前的加法運算中的 ToPrimitive 運算的部份，較為仔細的來研究 JS 中的相等比較(包含標準的與嚴格的)與關係比較的部份。至於沒提到的，不相等(==)與嚴格不相等(!==)，或是大於等於(&gt;=)或小於等於(&amp;#x3C;=)只是這些演算規劃的再組合結果而已。&lt;/p&gt;
&lt;p&gt;標準的值相等比較(==)，是一種有不經意的副作用的運算，不管如何，開發者必定要儘量避免，比較前可以自行轉換類型的方式，再作嚴格的相等比較，本章也有說明為何要避免使用它的理由。&lt;/p&gt;</content:encoded></item><item><title><![CDATA[JS中的 {} + {} 與 {} + [] 的結果是什麼？]]></title><link>https://eddychang.me/js-object-plus-object/</link><guid isPermaLink="false">https://eddychang.me/js-object-plus-object/</guid><content:encoded>&lt;p&gt;在 JS 中的運算符共同的情況中，(+)符號是很常見的一種，它有以下的使用情況:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;數字的加法運算，二元運算&lt;/li&gt;
&lt;li&gt;字串的連接運算，二元運算，最高優先&lt;/li&gt;
&lt;li&gt;正號，一元運算，可延伸為強制轉換其他類型的運算元為數字類型&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;當然，如果考慮多個符號一起使用時，(+=)與(++)又是另外的用途。&lt;/p&gt;
&lt;p&gt;另一個常見的是花括號({})，它有兩個用途也很常見:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;物件的字面文字定義&lt;/li&gt;
&lt;li&gt;區塊語句&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;所以，要能回答這個問題，要先搞清楚重點是什麼？&lt;/p&gt;
&lt;p&gt;第一個重點是:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;加號(+)運算在 JS 中在使用上的規定是什麼。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;第二個重點則是:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;物件在 JS 中是怎麼轉換為原始資料類型的值的。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;加號運算符(+)&lt;/h2&gt;
&lt;p&gt;除了上面說明的常見情況外，在標準中轉換的規則還有以下幾個，要注意它的順序:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;operand + operand = result&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;使用&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;運算轉換左與右運算元為原始資料類型值(primitive)&lt;/li&gt;
&lt;li&gt;在第 1 步轉換後，如果有運算元出現原始資料類型是”字串”類型值時，則另一運算元作強制轉換為字串，然後作字串的連接運算(concatenation)&lt;/li&gt;
&lt;li&gt;在其他情況時，所有運算元都會轉換為原始資料類型的”數字”類型值，然後作數學的相加運算(addition)&lt;/li&gt;
&lt;/ol&gt;
&lt;h2&gt;ToPrimitive 內部運算&lt;/h2&gt;
&lt;p&gt;因此，加號運算符只能使用於原始資料類型，那麼對於物件類型的值，要如何轉換為原始資料類型？下面說明是如何轉換為原始資料類型的。&lt;/p&gt;
&lt;p&gt;在&lt;a href=&quot;http://www.ecma-international.org/ecma-262/6.0/#sec-toprimitive&quot;&gt;ECMAScript 6th Edition #7.1.1&lt;/a&gt;，有一個抽象的&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;運算，它會用於物件轉換為原始資料類型，這個運算不只會用在加號運算符，也會用在關係比較或值相等比較的運算中。下面有關於&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;的說明語法:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ToPrimitive(input, PreferredType?)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;代表代入的值，而&lt;code class=&quot;language-text&quot;&gt;PreferredType&lt;/code&gt;可以是數字(Number)或字串(String)其中一種，這會代表”優先的”、“首選的”的要進行轉換到哪一種原始類型，轉換的步驟會依這裡的值而有所不同。但如果沒有提供這個值也就是預設情況，則會設定轉換的&lt;code class=&quot;language-text&quot;&gt;hint&lt;/code&gt;值為&lt;code class=&quot;language-text&quot;&gt;&amp;quot;default&amp;quot;&lt;/code&gt;。這個首選的轉換原始類型的指示(&lt;code class=&quot;language-text&quot;&gt;hint&lt;/code&gt;值)，是在作內部轉換時由 JS 視情況自動加上的，一般情況就是預設值。&lt;/p&gt;
&lt;p&gt;而在 JS 的&lt;code class=&quot;language-text&quot;&gt;Object&lt;/code&gt;原型的設計中，都一定會有兩個&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法，所以這兩個方法在所有物件裡面都會有，不過它們在轉換有可能會交換被呼叫的順序。&lt;/p&gt;
&lt;h3&gt;當 PreferredType 為數字(Number)時&lt;/h3&gt;
&lt;p&gt;當&lt;code class=&quot;language-text&quot;&gt;PreferredType&lt;/code&gt;為數字(Number)時，&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;為要被轉換的值，以下是轉換這個&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;值的步驟:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;如果&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;是原始資料類型，則直接回傳&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;否則，如果&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;是個物件時，則呼叫物件的&lt;code class=&quot;language-text&quot;&gt;valueOf()&lt;/code&gt;方法，如果能得到原始資料類型的值，則回傳這個值。&lt;/li&gt;
&lt;li&gt;否則，如果&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;是個物件時，呼叫物件的&lt;code class=&quot;language-text&quot;&gt;toString()&lt;/code&gt;方法，如果能得到原始資料類型的值，則回傳這個值。&lt;/li&gt;
&lt;li&gt;否則，拋出 TypeError 錯誤。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;當 PreferredType 為字串(String)時&lt;/h3&gt;
&lt;p&gt;上面的步驟 2 與 3 對調，如同下面所說:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;如果&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;是原始資料類型，則直接回傳&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;。&lt;/li&gt;
&lt;li&gt;否則，如果&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;是個物件時，呼叫物件的&lt;code class=&quot;language-text&quot;&gt;toString()&lt;/code&gt;方法，如果能得到原始資料類型的值，則回傳這個值。&lt;/li&gt;
&lt;li&gt;否則，如果&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;是個物件時，則呼叫物件的&lt;code class=&quot;language-text&quot;&gt;valueOf()&lt;/code&gt;方法，如果能得到原始資料類型的值，則回傳這個值。&lt;/li&gt;
&lt;li&gt;否則，拋出 TypeError 錯誤。&lt;/li&gt;
&lt;/ol&gt;
&lt;h3&gt;PreferredType 沒提供時，也就是 hint 為”default”時&lt;/h3&gt;
&lt;p&gt;與&lt;code class=&quot;language-text&quot;&gt;PreferredType&lt;/code&gt;為數字(Number)時的步驟相同。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;數字&lt;/strong&gt;其實是預設的首選類型，也就是說在一般情況下，加號運算中的物件要作轉型時，都是先呼叫&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;再呼叫&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;但這有兩個例外，一個是&lt;code class=&quot;language-text&quot;&gt;Date&lt;/code&gt;物件，另一是&lt;code class=&quot;language-text&quot;&gt;Symbol&lt;/code&gt;物件，它們覆蓋了原來的&lt;code class=&quot;language-text&quot;&gt;PreferredType&lt;/code&gt;行為，&lt;code class=&quot;language-text&quot;&gt;Date&lt;/code&gt;物件的預設首選類型是字串(String)。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;因此你會看到在一些教學文件上會區分為兩大類物件，一類是 Date 物件，另一類叫 非 Date(non-date) 物件。因為這兩大類的物件在進行轉換為原始資料類型時，首選類型恰好相反。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;模擬程式碼說明&lt;/h3&gt;
&lt;p&gt;以簡單的模擬程式碼來說明，加號運算符(+)的執行過程就是像下面這個模擬碼一樣，我想這會很容易理解:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;a &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;
    pa &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ToPrimitive&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    pb &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ToPrimitive&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pa is string &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; pb is string&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
       &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ToString&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pa&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ToString&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
       &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;ToNumber&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pa&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;ToNumber&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;pb&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;步驟簡單來說就是，運算元都用&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;先轉換為原始資料類型，然後其一是字串時，使用&lt;code class=&quot;language-text&quot;&gt;ToString&lt;/code&gt;強制轉換另一個運算元，然後作字串連接運算。要不然，就是都使用&lt;code class=&quot;language-text&quot;&gt;ToNumber&lt;/code&gt;強制轉換為數字作加法運算。&lt;/p&gt;
&lt;p&gt;而&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;在遇到物件類型時，預設呼叫方式是先呼叫&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;再呼叫&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;，一般情況數字類型是首選類型。&lt;/p&gt;
&lt;p&gt;上面說的&lt;code class=&quot;language-text&quot;&gt;ToString&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;ToNumber&lt;/code&gt;這兩個也是 JS 內部的抽象運算。&lt;/p&gt;
&lt;h2&gt;valueOf 與 toString 方法&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;ToString&lt;/code&gt;是在 Object 中的兩個必有的方法，位於 Object.prototype 上，它是物件要轉為原始資料類型的兩個姐妹方法。從上面的內容已經可以看到，&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;這個抽象的內部運算，會依照設定的首選的類型，決定要先後呼叫&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法的順序，當數字為首選類型時，優先使用&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;，然後再呼叫&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;。當字串為首選類型時，則是相反的順序。預設呼叫方式則是如數字首選類型一樣，是先呼叫&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;再呼叫&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;。&lt;/p&gt;
&lt;h3&gt;JS 對於 Object 與 Array 的設計&lt;/h3&gt;
&lt;p&gt;在 JS 中所設計的&lt;code class=&quot;language-text&quot;&gt;Object&lt;/code&gt;純物件類型的&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法，它們的回傳如下:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;方法回傳值: 物件本身。&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法回傳值: ”[object Object]“字串值，不同的內建物件的回傳值是”[object type]“字串，“type”指的是物件本身的類型識別，例如 Math 物件是回傳”[object Math]“字串。但有些內建物件因為覆蓋了這個方法，所以直接呼叫時不是這種值。(注意: 這個回傳字串的前面的”object”開頭英文是小寫，後面開頭英文是大寫)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;你有可能會看過，利用 Object 中的 toString 來進行各種不同物件的判斷語法，這在以前 JS 能用的函式庫或方法不多的年代經常看到，不過它需要配合使用函式中的&lt;code class=&quot;language-text&quot;&gt;call&lt;/code&gt;方法，才能輸出正確的物件類型值，例如:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;prototype&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;toString&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;[object Array]&quot;&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;prototype&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;toString&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;call&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;[object Date]&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;所以，從上面的內容就可以知道，下面的這段程式碼的結果會是呼叫到&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法(因為&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;方法的回傳並不是原始的資料類型):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;1[object Object]&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;一元正號(+)，具有讓首選類型(也就是 hint)設置為數字(Number)的功能，所以可以強制讓物件轉為數字類型，一般的物件會轉為:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//相當於 +&quot;[object Object]&quot;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// NaN&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;當然，物件的這兩個方法都可以被覆蓋，你可以用下面的程式碼來觀察這兩個方法的執行順序，下面這個都是先呼叫&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;的情況:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  valueOf&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;valueOf&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// object&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  toString&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;toString&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;obj&apos;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// string&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//valueOf -&gt; toString -&gt; &apos;1obj&apos;&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//valueOf -&gt; toString -&gt; NaN&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//valueOf -&gt; toString -&gt; &apos;obj&apos;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;先呼叫&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;的情況比較少見，大概只有&lt;code class=&quot;language-text&quot;&gt;Date&lt;/code&gt;物件或強制要轉換為字串時才會看到:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  valueOf&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;valueOf&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// number&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  toString&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;toString&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// object&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//toString -&gt; valueOf -&gt; alert(&quot;1&quot;);&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;String&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//toString -&gt; valueOf -&gt; &quot;1&quot;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;而下面這個例子會造成錯誤，因為不論順序是如何都得不到原始資料類型的值，錯誤訊息是”TypeError: Cannot convert object to primitive value”，從這個訊息中很明白的告訴你，它這裡面會需要轉換物件到原始資料類型:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  valueOf&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;valueOf&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// object&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  toString&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&apos;toString&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// string&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;obj &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; obj&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//valueOf -&gt; toString -&gt; error!&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;Array(陣列)很常用到，雖然它是個物件類型，但它與 Object 的設計不同，它的&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;有覆蓋，說明一下陣列的&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;的兩個方法的回傳值:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;方法回傳值: 物件本身。(與 Object 一樣)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法回傳值: 相當於用陣列值呼叫&lt;code class=&quot;language-text&quot;&gt;join(&amp;#39;,&amp;#39;)&lt;/code&gt;所回傳的字串。也就是&lt;code class=&quot;language-text&quot;&gt;[1,2,3].toString()&lt;/code&gt;會是&lt;code class=&quot;language-text&quot;&gt;&amp;quot;1,2,3&amp;quot;&lt;/code&gt;，這點要特別注意。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Function 物件很少會用到，它的&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;也有被覆蓋，所以並不是 Object 中的那個&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;，Function 物件的&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;的兩個方法的回傳值:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;方法回傳值: 物件本身。(與 Object 一樣)&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法回傳值: 函式中包含的程式碼轉為字串值&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Number、String、Boolean 三個包裝物件&lt;/h3&gt;
&lt;p&gt;包裝物件是 JS 為原始資料類型數字、字串、布林專門設計的物件，所有的這三種原始資料類型所使用到的屬性與方法，都是在這上面所提供。&lt;/p&gt;
&lt;p&gt;包裝物件的&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;的兩個方法在原型上有經過覆蓋，所以它們的回傳值與一般的 Object 的設計不同:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;方法回傳值: 對應的原始資料類型值&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法回傳值: 對應的原始資料類型值，轉換為字串類型時的字串值&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法會比較特別，這三個包裝物件裡的&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;的細部說明如下:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Number 包裝物件的&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法: 可以有一個傳入參數，可以決定轉換為字串時的進位(2、8、16)&lt;/li&gt;
&lt;li&gt;String 包裝物件的&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法: 與 String 包裝物件中的&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;相同回傳結果&lt;/li&gt;
&lt;li&gt;Boolean 包裝物件的&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法: 回傳”true”或”false”字串&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;另外，常被搞混的是直接使用&lt;code class=&quot;language-text&quot;&gt;Number()&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;String()&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;Boolean()&lt;/code&gt;三個強制轉換函式的用法，這與包裝物件的用法不同，包裝物件是必須使用&lt;code class=&quot;language-text&quot;&gt;new&lt;/code&gt;關鍵字進行物件實體化的，例如&lt;code class=&quot;language-text&quot;&gt;new Number(123)&lt;/code&gt;，而&lt;code class=&quot;language-text&quot;&gt;Number(&amp;#39;123&amp;#39;)&lt;/code&gt;則是強制轉換其他類型為數字類型的函式。&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Number()&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;String()&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;Boolean()&lt;/code&gt;三個強制轉換函式，所對應的就是在 ECMAScript 標準中的&lt;code class=&quot;language-text&quot;&gt;ToNumber&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;ToString&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;ToBoolean&lt;/code&gt;三個內部運算轉換的對照表。而當它們要轉換物件類型前，會先用上面說的&lt;code class=&quot;language-text&quot;&gt;ToPrimitive&lt;/code&gt;先轉換物件為原始資料類型，再進行轉換到所要的類型值。&lt;/p&gt;
&lt;p&gt;不管如何，包裝物件很少會被使用到，一般我們只會直接使用原始資料類型的值。而強制轉換函式因為也有取代的語法，它們會被用到的機會也不多。&lt;/p&gt;
&lt;h2&gt;應用實例&lt;/h2&gt;
&lt;h3&gt;字串 + 其他原始類型&lt;/h3&gt;
&lt;p&gt;字串在加號運算有最高的優先運算，與字串相加必定是字串連接運算(concatenation)。所有的其他原始資料類型轉為字串，可以參考 ECMAScript 標準中的&lt;a href=&quot;http://www.ecma-international.org/ecma-262/6.0/#sec-tostring&quot;&gt;ToString&lt;/a&gt;對照表，以下為一些簡單的範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;123&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;1123&quot;&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;1false&quot;&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;1null&quot;&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;1&apos;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; undefined
&lt;span class=&quot;token string&quot;&gt;&quot;1undefined&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;數字 + 其他的非字串的原始資料類型&lt;/h3&gt;
&lt;p&gt;數字與其他類型作相加時，除了字串會優先使用字串連接運算(concatenation)的，其他都要依照數字為優先，所以除了字串之外的其他原始資料類型，都要轉換為數字來進行數學的相加運算。如果明白這項規則，就會很容易的得出加法運算的結果。&lt;/p&gt;
&lt;p&gt;所有轉為數字類型可以參考 ECMAScript 標準中的&lt;a href=&quot;http://www.ecma-international.org/ecma-262/6.0/#sec-tonumber&quot;&gt;ToNumber&lt;/a&gt;對照表，以下為一些簡單的範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//true轉為1, false轉為0&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;//null轉為0&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; undefined &lt;span class=&quot;token comment&quot;&gt;//null轉為NaN&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;NaN&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;數字/字串以外的原始資料類型作加法運算&lt;/h3&gt;
&lt;p&gt;所以，當數字與字串以外的其他原始資料類型直接使用加號運算時，就是轉為數字再運算，這與字串無關。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; undefined &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;NaN&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;空陣列 + 空陣列&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;兩個陣列相加，依然按照&lt;code class=&quot;language-text&quot;&gt;valueOf -&amp;gt; toString&lt;/code&gt;的順序，但因為&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;是陣列本身，所以會以&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;的回傳值才是原始資料類型，也就是空字串，所以這個運算相當於兩個空字串在相加，依照加法運算規則第 2 步驟，是字串連接運算(concatenation)，兩個空字串連接最後得出一個空字串。&lt;/p&gt;
&lt;h3&gt;空物件 + 空物件&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;[object Object][object Object]&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;兩個空物件相加，依然按照&lt;code class=&quot;language-text&quot;&gt;valueOf -&amp;gt; toString&lt;/code&gt;的順序，但因為&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;是物件本身，所以會以&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;的回傳值才是原始資料類型，也就是”[object Object]“字串，所以這個運算相當於兩個”[object Object]“字串在相加，依照加法運算規則第 2 步驟，是字串連接運算(concatenation)，最後得出一個”&lt;a href=&quot;&quot;&gt;object Object&lt;/a&gt;“字串。&lt;/p&gt;
&lt;p&gt;但是這個結果有例外，上面的結果只是在 Chrome 瀏覽器上的結果(v55)，怎麼說呢？&lt;/p&gt;
&lt;p&gt;有些瀏覽器例如 Firefox、Edge 瀏覽器會把&lt;code class=&quot;language-text&quot;&gt;{} + {}&lt;/code&gt;直譯為相當於&lt;code class=&quot;language-text&quot;&gt;+{}&lt;/code&gt;語句，因為它們會認為以花括號開頭(&lt;code class=&quot;language-text&quot;&gt;{&lt;/code&gt;)的，是一個區塊語句的開頭，而不是一個物件字面量的語句，所以會認為略過第一個&lt;code class=&quot;language-text&quot;&gt;{}&lt;/code&gt;，把它認為是個&lt;code class=&quot;language-text&quot;&gt;+{}&lt;/code&gt;的語句，也就是相當於強制求出數字值的&lt;code class=&quot;language-text&quot;&gt;Number({})&lt;/code&gt;運算，相當於&lt;code class=&quot;language-text&quot;&gt;Number(&amp;quot;[object Object]&amp;quot;)&lt;/code&gt;運算，最後得出的是&lt;code class=&quot;language-text&quot;&gt;NaN&lt;/code&gt;。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;特別注意: &lt;code class=&quot;language-text&quot;&gt;{} + {}&lt;/code&gt;在不同的瀏覽器有不同結果&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;如果在第一個(前面)的空物件加上圓括號(&lt;code class=&quot;language-text&quot;&gt;()&lt;/code&gt;)，這樣 JS 就會認為前面是個物件，就可以得出同樣的結果:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;[object Object][object Object]&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;或是分開來先定義物件的變數值，也可以得出同樣的結果，像下面這樣:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; foo &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; bar &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; foo &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; bar&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 上面說的行為這與加號運算的第一個(前面)的物件字面值是不是個空物件無關，就算是裡面有值的物件字面，例如&lt;code class=&quot;language-text&quot;&gt;{a:1, b:2}&lt;/code&gt;，也是同樣的結果。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;空物件 + 空陣列&lt;/h3&gt;
&lt;p&gt;上面同樣的把&lt;code class=&quot;language-text&quot;&gt;{}&lt;/code&gt;當作區塊語句的情況又會發生，不過這次所有的瀏覽器都會有一致結果，如果&lt;code class=&quot;language-text&quot;&gt;{}&lt;/code&gt;(空物件)在前面，而&lt;code class=&quot;language-text&quot;&gt;[]&lt;/code&gt;(空陣列)在後面時，前面那個會被認為是區塊而不是物件。&lt;/p&gt;
&lt;p&gt;所以&lt;code class=&quot;language-text&quot;&gt;{} + []&lt;/code&gt;相當於&lt;code class=&quot;language-text&quot;&gt;+[]&lt;/code&gt;語句，也就是相當於強制求出數字值的&lt;code class=&quot;language-text&quot;&gt;Number([])&lt;/code&gt;運算，相當於&lt;code class=&quot;language-text&quot;&gt;Number(&amp;quot;&amp;quot;)&lt;/code&gt;運算，最後得出的是&lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;數字。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;

&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token string&quot;&gt;&quot;[object Object]&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;特別注意: 所以如果第一個(前面)是&lt;code class=&quot;language-text&quot;&gt;{}&lt;/code&gt;時，後面加上其他的像陣列、數字或字串，這時候加號運算會直接變為一元正號運算，也就是強制轉為數字的運算。這是個陷阱要小心。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;Date 物件&lt;/h3&gt;
&lt;p&gt;Date 物件的&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;的兩個方法的回傳值:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;方法回傳值:&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;方法回傳值:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Date 物件上面有提及是首選類型為”字串”的一種例外的物件，這與其他的物件的行為不同(一般物件會先呼叫&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;再呼叫&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;)，在進行加號運算時時，它會優先使用&lt;code class=&quot;language-text&quot;&gt;toString&lt;/code&gt;來進行轉換，最後必定是字串連接運算(concatenation)，例如以下的結果:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;1Sun Nov 27 2016 01:09:03 GMT+0800 (CST)&quot;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;要得出 Date 物件中的&lt;code class=&quot;language-text&quot;&gt;valueOf&lt;/code&gt;回傳值，需要使用一元加號(+)，來強制轉換它為數字類型，例如以下的程式碼:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Date&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;1480180751492&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;Symbols 類型&lt;/h3&gt;
&lt;p&gt;ES6 中新加入的 Symbols 資料類型，它不算是值也不是物件，所以完全不能直接用於加法運算，它並沒有內部自動轉型的設計，使用時會報錯。&lt;/p&gt;
&lt;h2&gt;結論&lt;/h2&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;{} + {}&lt;/code&gt;的結果是會因瀏覽器而有不同結果，Chrome 中是&lt;code class=&quot;language-text&quot;&gt;[object Object][object Object]&lt;/code&gt;字串連接，但其它的瀏覽器則是認為相當於&lt;code class=&quot;language-text&quot;&gt;+{}&lt;/code&gt;運算，得出&lt;code class=&quot;language-text&quot;&gt;NaN&lt;/code&gt;數字類型。&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;{} + []&lt;/code&gt;的結果是相當於&lt;code class=&quot;language-text&quot;&gt;+[]&lt;/code&gt;，結果是&lt;code class=&quot;language-text&quot;&gt;0&lt;/code&gt;數字類型。&lt;/p&gt;
&lt;h2&gt;參考資料&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://www.2ality.com/2012/01/object-plus-object.html&quot;&gt;What is {} + {} in JavaScript?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[中文輸入法與React文字輸入框的問題與解決方案]]></title><link>https://eddychang.me/react-chinese-ime-issue/</link><guid isPermaLink="false">https://eddychang.me/react-chinese-ime-issue/</guid><content:encoded>&lt;p&gt;問題來源是來自這個 React 官方儲存庫的 issue &lt;a href=&quot;https://github.com/facebook/react/issues/3926&quot;&gt;#3926&lt;/a&gt;，與這個議題關聯的有很多其他的 issue，來自許多專案，有些是與 React 相關，有些則是 vue 或其它 JS 套件。也已經有其他的專案是專注於解決這個問題，例如&lt;a href=&quot;https://github.com/fast-flow/react-composition&quot;&gt;react-composition&lt;/a&gt;，不過它是一個使用 ES5 語法的 React 元件。在其他的討論區上也有類似的&lt;a href=&quot;http://react-china.org/t/onchange-input/3385&quot;&gt;問題與解答&lt;/a&gt;。本文的目的是希望能針對這個問題提供一些說明、現在暫時性的解決方案。&lt;/p&gt;
&lt;p&gt;下圖為目前解決 React 中”Controlled”(受控制的)input 元件的展示，可以到&lt;a href=&quot;https://eyesofkids.github.io/&quot;&gt;這裡&lt;/a&gt;去測試:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/demo-e4cac1ad946f6171fcef5835c107b9e1.gif&quot; alt=&quot;展示&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注意事項: 目前的解決方案我認為是暫時性的，結果都放在這個&lt;a href=&quot;https://github.com/eyesofkids/react-compositionevent&quot;&gt;github 庫&lt;/a&gt;上。這要分為”Controlled”(受控制的)與”Uncontrolled”(不受控制的)兩個種類的元件，影響的主要是 input 與 textarea 兩個元件，輸入法(IME, input method editor)的問題，不只會發生在中文，同樣的在日文、韓文或其它使用輸入法的語言應該都有同樣問題。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;問題何來&lt;/h2&gt;
&lt;p&gt;React 元件主要使用&lt;code class=&quot;language-text&quot;&gt;onChange&lt;/code&gt;人造事件，作為文字輸入框(input)或文字輸入區域(textarea)觸發文字輸入時的事件，這個事件用起來很直覺，理應當是如此。但&lt;code class=&quot;language-text&quot;&gt;onChange&lt;/code&gt;在瀏覽器上，只要在這個文字輸入框上，有任何的鍵盤動作它都會觸發，也就是如果你是使用了中文、日文、韓文輸入法(IME)，不論是哪一種，拼音的、筆劃的還是其他的，只要有按下一個鍵盤的動作，就會觸發一次瀏覽器上這個元素的&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件，對於原本就使用鍵盤上的英文字元作為輸入的語言來說，這沒什麼太大的問題，但對於要使用輸入法的語言使用者來說，不停的觸發&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件，可能會造成程式功能上的運行邏輯問題。&lt;/p&gt;
&lt;p&gt;舉出一個實際的應用情況，一個使用 React 撰寫的搜尋電腦書籍的功能，使用者可以在文字輸入框裡輸入要搜尋的書名，程式中是利用&lt;code class=&quot;language-text&quot;&gt;onChange&lt;/code&gt;事件觸發，進行比對資料庫中的書籍標題，當你想搜尋一本名為”林哥的 Java 教學”，第一個字為”林”，拼音輸入法需要輸入”lin”三個鍵盤上的字元，在”林”這個字從輸入法編輯器中加到真正的 input 元素前，&lt;code class=&quot;language-text&quot;&gt;onChange&lt;/code&gt;已經捕捉到”lin”三個字元，在列表中已搜尋出一大堆有關”linux”的書籍。細節就不說了，還有可能對字元數量的的檢查之類的問題。不過，這是正確的程式運作邏輯嗎?很明顯的這是一個大問題。&lt;/p&gt;
&lt;p&gt;當然，你也可以用對中文字詞檢查的修正方式，或是乾脆不要用&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件，改用其他按鈕觸發之類的事件來作這事情，或是不要用 React 中的”Controlled”(受控制的)input 或 textare 元件，但這會局限住在程式開發應用上的自由，要如何選擇就看你自己了，是不要使用它還是想辦法正視問題來解決它。&lt;/p&gt;
&lt;h2&gt;網頁上的 DOM 元素與”Uncontrolled”(不受控制的)的元件&lt;/h2&gt;
&lt;p&gt;這個問題在瀏覽器中，早就已經有了可應對的解決方法，DOM 事件中有一組額外的&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/CompositionEvent&quot;&gt;CompositionEvent&lt;/a&gt;(組成事件)可以輔助開發者，它可以在可編輯的 DOM 元素上觸發，主要是 input 與 textarea 上，所以可以用來輔助解決&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件的輸入法問題。CompositionEvent(組成事件)共有三個事件，分別為&lt;code class=&quot;language-text&quot;&gt;compositionstart&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;compositionupdate&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;compositionend&lt;/code&gt;，它們代表的是開始進行字的組成、更新與結束，也就是代表開始以輸入法編輯器來組合鍵盤上的英文字元，選字或更新字的組合，到最後輸出字到真實 DOM 中的文字輸入框中，實務上每個中文字在輸入時，&lt;code class=&quot;language-text&quot;&gt;compositionstart&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;compositionend&lt;/code&gt;都只會會被觸發一次，而&lt;code class=&quot;language-text&quot;&gt;compositionupdate&lt;/code&gt;則是有可能多次觸發。&lt;/p&gt;
&lt;p&gt;藉由 CompositionEvent 的輔助來解決的方式，也就是說在網頁上的 input 元素，可以利用 CompositionEvent 作為一個信號，如果正在使用 IME 輸入中文時，&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件中的程式碼就先不要執行，等&lt;code class=&quot;language-text&quot;&gt;compositionend&lt;/code&gt;觸發時，接著的&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件才可以執行其中的程式碼，運作的原理就是這樣簡單而已。&lt;/p&gt;
&lt;p&gt;在 React 應用中，如果是一個”Uncontrolled”(不受控制的)的 input 元件，它與網頁上真實 DOM 中的 input 元素的事件行為無差異，也就是說，直接使用 CompositionEvent 的解決方式，就可以解決這個輸入法的問題，以下面的程式碼為範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// @flow&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; React &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;react&apos;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;Cinput&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Object&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// record if is on Composition&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; isOnComposition&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; boolean &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;handleComposition&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; KeyboardEvent&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;compositionend&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;// composition is end&lt;/span&gt;
      isOnComposition &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;// in composition&lt;/span&gt;
      isOnComposition &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;handleChange&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; KeyboardEvent&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// only when onComposition===false to fire onChange&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target &lt;span class=&quot;token keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HTMLInputElement&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;isOnComposition&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      props&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;onChange&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;input
      &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      onCompositionStart&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;handleComposition&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      onCompositionUpdate&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;handleComposition&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      onCompositionEnd&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;handleComposition&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      onChange&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;handleChange&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
    &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; Cinput&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;上面這是一個典型的”Uncontrolled”(不受控制的)input 元件，主要是它不用&lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt;這個屬性。但如果它有來自上層元件的&lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt;屬性與值，也就是上層元件用 props 傳遞給它&lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt;屬性的值，就成了”Controlled”(受控制的)元件，它的事件整個模式就會與網頁上的真實 DOM 中的 input 元素不一樣，這後面再說明。&lt;/p&gt;
&lt;p&gt;這個解決方案在幾乎所有能支援 CompositionEvent 的瀏覽器(IE9 以上)都可以運行得很好，不過在 Google Chrome 瀏覽器在 2016 年的版本 53 之後，更動了&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;compositionend&lt;/code&gt;的&lt;a href=&quot;https://chromium.googlesource.com/chromium/src/+/afce9d93e76f2ff81baaa088a4ea25f67d1a76b3%5E%21/&quot;&gt;觸發順序&lt;/a&gt;，所以需要針對 Chrome 瀏覽器調整一下，如果是在 Chrome 瀏覽器中觸發&lt;code class=&quot;language-text&quot;&gt;compositionend&lt;/code&gt;時，也要執行一次在原本在&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;要執行的程式碼，就改成這樣而已。下面在上個程式碼中的&lt;code class=&quot;language-text&quot;&gt;handleComposition&lt;/code&gt;函式中，多加了偵測是否為 Chrome 瀏覽器，與觸發原本的 onChange 方法程式碼，修改過的程式碼如下:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// detect it is Chrome browser?&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; isChrome &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;chrome &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;window&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;chrome&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;webstore

&lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;handleComposition&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; KeyboardEvent&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;compositionend&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// composition is end&lt;/span&gt;
    isOnComposition &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// fixed for Chrome v53+ and detect all Chrome&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// https://chromium.googlesource.com/chromium/src/&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// +/afce9d93e76f2ff81baaa088a4ea25f67d1a76b3%5E%21/&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target &lt;span class=&quot;token keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HTMLInputElement&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;isOnComposition &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; isChrome&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;// fire onChange&lt;/span&gt;
      props&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;onChange&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// in composition&lt;/span&gt;
    isOnComposition &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;“Uncontrolled”(不受控制的)input 或 textarea 元件，解決方式就是這麼簡單而已，利用 CompositionEvent 過濾掉不必要的&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 其它的解決方式還有，像&lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/API/InputEvent&quot;&gt;InputEvent&lt;/a&gt;中有一個&lt;code class=&quot;language-text&quot;&gt;isComposing&lt;/code&gt;屬性，它也可以作為偵測目前是否正在進行輸入法的組字工作，但 InputEvent 事件目前只有 Firefox 中可以用，看起來沒什麼前景。另外，W3C 新提出的&lt;a href=&quot;https://www.w3.org/TR/ime-api/&quot;&gt;IME API&lt;/a&gt;或許是一個未來較佳的解決方案，但目前只有&lt;a href=&quot;https://blogs.msdn.microsoft.com/ie/2014/03/31/building-better-input-experience-for-east-asian-users-with-the-ime-api-in-ie11/&quot;&gt;IE11 有實作&lt;/a&gt;，其他瀏覽器品牌都沒有。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;“Controlled”(受控制的)的元件&lt;/h2&gt;
&lt;p&gt;在 React 應用中，使用”Controlled”(受控制的)的 input 或 textarea 元件是另一回事，它會開始複雜起來。&lt;/p&gt;
&lt;p&gt;“Controlled”(受控制的)的元件並不是只有加上&lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt;這個屬性這麼簡單，input 或 textarea 元件所呈現的值，主要會來自 state，state 有可能是上層元件的，利用 props 一層層傳遞過來的，或是這個元件中本身就有的 state，直接指定給在這個元件中的 render 中的 input 或 textarea 元件。也就是說，input 最後呈現的文字如果要進行改變，就需要改變到元件(不論在何處)的 state，要改變 state 只有透過 setState 方法，而 setState 方法有可能是個異步(延時)執行的情況。&lt;/p&gt;
&lt;p&gt;把這整個流程串接在一起後，我相信事件觸發的不連續情況會變得很嚴重，需要對不同情況下作測試與評估。目前我所作的測試還只是最基本的元件運用而已，複雜的元件情況還沒有開始進行。因為 state 有很多種用途，有時候內部使用，有時候要對外部使用者輸入介面的事件，或是有時候要對伺服器端的資料接收或傳送，不論是不是要使用 Redux、MobX 或 Flux 之類的 state 容器函式庫或框架，最終要進行重新渲染的工作，還是得呼叫 React 中的 setState 方法才行。&lt;/p&gt;
&lt;p&gt;在基本的測試時，我發現”Controlled”(受控制的)的 input 元件，它不僅事件觸發不連續的情況嚴重，而且有可能在不同瀏覽器上會有不同的結果。完全不會有問題的只有一個瀏覽器，就是上面註解中所說的已經實作出&lt;a href=&quot;https://www.w3.org/TR/ime-api/&quot;&gt;IME API&lt;/a&gt;的 IE11，IE11 上可能根本不需要任何解決方案，它的輸入法編輯器是獨立於瀏覽器上的文字輸入框之外的。&lt;/p&gt;
&lt;p&gt;目前已測試的結果是有三種情況，“Chrome, Opera, IE, Edge”為一種，“Firefox”為一種，“Safari”為一種。我為這三種情況分別寫了不同的解決方式的程式碼，但這個事件觸發的不連續情況，現在無法有一致性的解決方案，我只能推測這大概可能是 React 內部設計的問題。&lt;/p&gt;
&lt;p&gt;不論是三種的那一種解決方案，有一個重點是你不能像上面的一般性解決方案，阻擋&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件時要執行的程式碼，也就是阻擋&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;變動&lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt;值，因為只要一經阻擋，&lt;code class=&quot;language-text&quot;&gt;input&lt;/code&gt;元件的&lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt;值就指定不到值，而且也不會觸發重新渲染。所以你只能讓&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件不斷觸發，就像往常一樣。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;那麼要如何解決程式邏輯運作的問題？&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我使用了另一個內部的 state 物件中的值，稱為&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;，它是對比在 input 元件上不斷因觸發&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件而輸入的值，稱為&lt;code class=&quot;language-text&quot;&gt;inputValue&lt;/code&gt;。&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;是個會經過 CompositionEvent 修正過的值，所以它永遠不會帶有在輸入法組字過程的字串值。&lt;/p&gt;
&lt;p&gt;這個解決方案，是一個”掛羊頭賣狗肉”的用法，不論使用者在 input 元件如何輸入，輸入的過程都會改變&lt;code class=&quot;language-text&quot;&gt;inputValue&lt;/code&gt;而已，&lt;code class=&quot;language-text&quot;&gt;inputValue&lt;/code&gt;是一個暫存與呈現用的值，最終用來進行程式邏輯運算的是&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;。以最一開始的例子來說，使用者輸入”林哥的 Java 教學”，在一開始的”林”字輸入時，&lt;code class=&quot;language-text&quot;&gt;inputValue&lt;/code&gt;是從”lin”到輸入完成變為”林”，而&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;是在輸入期間是空字串值，輸入完成才會變為”林”。所以，搜尋功能可以用&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;來作為運算的依據，用這個值來搜尋對應的資料，這才是正確的運算邏輯，因為&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;才是真正的不帶輸入法組字過程的值。&lt;/p&gt;
&lt;p&gt;大致上說明一下解決方式的程式碼，首先它有兩個在這個模組作用域中的全域變數，一個用來記錄是否在輸入法的組字過程中，另一個是給專給 Safari 瀏覽器用的:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// if now is in composition session&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; isOnComposition &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// for safari use only, innervalue can&apos;t setState when compositionend occurred&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;let&lt;/span&gt; isInnerChangeFromOnChange &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;在專門處理&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件的&lt;code class=&quot;language-text&quot;&gt;handleChange&lt;/code&gt;方法中，判斷&lt;code class=&quot;language-text&quot;&gt;isInnerChangeFromOnChange&lt;/code&gt;這一段是專門為了解決 Safari 瀏覽器的問題所寫，Safari 瀏覽器的行為是 CompositionEvent 在觸發時，其中的&lt;code class=&quot;language-text&quot;&gt;event.target.value&lt;/code&gt;居然是組字過程中的英文字元，而不是觸發這個事件的 input 元素的所有字串，這也是特別怪異的地方，所以才會利用在&lt;code class=&quot;language-text&quot;&gt;compositionend&lt;/code&gt;後會再觸發一次&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;的特性，在這裡更新&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;後面的程式碼，是代表在輸入法的組字過程中，setState 方法使用的差異，在組字過程中(&lt;code class=&quot;language-text&quot;&gt;isOnComposition === true&lt;/code&gt;)的話，只會更動&lt;code class=&quot;language-text&quot;&gt;inputValue&lt;/code&gt;值，而不會更動到&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;的值，這對應了上述所說的一個運作過程，一般的輸入鍵盤上的字元時不會有輸入法的問題，則是兩個值一併更動。程式碼如下:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function-variable function&quot;&gt;handleChange&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// console.log(&apos;change type &apos;, e.type, &apos;, target &apos;, e.target, &apos;, target.value &apos;, e.target.value)&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Flow check&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target &lt;span class=&quot;token keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HTMLInputElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;isInnerChangeFromOnChange&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; inputValue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; innerValue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    isInnerChangeFromOnChange &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// when is on composition, change inputValue only&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// when not in composition change inputValue and innerValue both&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;isOnComposition&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      inputValue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
      innerValue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; inputValue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;在專門處理&lt;code class=&quot;language-text&quot;&gt;composition&lt;/code&gt;事件的&lt;code class=&quot;language-text&quot;&gt;handleComposition&lt;/code&gt;方法中，主要是為了在&lt;code class=&quot;language-text&quot;&gt;compositionend&lt;/code&gt;觸發時，進行更新&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;所撰寫的一些程式碼。在第一種情況時，也就是在 Chrome, IE, Edge, Opera 瀏覽器時，只需要直接用&lt;code class=&quot;language-text&quot;&gt;e.target.value&lt;/code&gt;更新&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;即可。在第二種情況是 Firefox，它不知道為什麼會掉值，所以還需要幫它再一併更新&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;一次。第三種情況，上面有說過了，特別的怪異情況，所以對&lt;code class=&quot;language-text&quot;&gt;innerValue&lt;/code&gt;的更新改到&lt;code class=&quot;language-text&quot;&gt;compositionend&lt;/code&gt;之後的那個&lt;code class=&quot;language-text&quot;&gt;change&lt;/code&gt;事件去作了。程式碼如下:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function-variable function&quot;&gt;handleComposition&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; Event&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token comment&quot;&gt;// console.log(&apos;type &apos;, e.type, &apos;, target &apos;, e.target, &apos;,target.value &apos;, e.target.value, &apos;, data&apos;, e.data)&lt;/span&gt;

  &lt;span class=&quot;token comment&quot;&gt;// Flow check&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target &lt;span class=&quot;token keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;HTMLInputElement&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;type &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;compositionend&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Chrome is ok for only setState innerValue&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// Opera, IE and Edge is like Chrome&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;isChrome &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; isIE &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; isEdge &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; isOpera&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; innerValue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// Firefox need to setState inputValue again...&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;isFirefox&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; innerValue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; inputValue&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    &lt;span class=&quot;token comment&quot;&gt;// Safari think e.target.value in composition event is keyboard char,&lt;/span&gt;
    &lt;span class=&quot;token comment&quot;&gt;// but it will fire another change after compositionend&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;isSafari&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;// do change in the next change event&lt;/span&gt;
      isInnerChangeFromOnChange &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

    isOnComposition &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    isOnComposition &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;註: 目前這個暫時的解決方式，其方式並不是參考自&lt;a href=&quot;https://github.com/fast-flow/react-composition&quot;&gt;react-composition&lt;/a&gt;項目，解決方式雖然有些類似，但 react-composition 用的是 ES5 的 React 工廠樣式元件語法，我對這種語法並不熟悉。在寫這篇文章時，才仔細看了一下 react-composition 的程式碼，只能說它的作者實際上也有測試過這個問題，也知道只有用另一個 state 中的值才能解決這問題。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;總結&lt;/h2&gt;
&lt;p&gt;如果你是使用”Uncontrolled”(不受控制的)的元件，那麼解決方法很簡單，就如同上面所說的，像一般的網頁上的 DOM 元素的解決方式即可。&lt;/p&gt;
&lt;p&gt;但對於”Controlled”(受控制的)的元件來說，目前的解決方案是一種 try-and-error(試誤法)的暫時性解決方案，我目前只能按照已測試的平台與瀏覽器去修正，沒測過的瀏覽器與平台，就不得而知了。&lt;/p&gt;
&lt;p&gt;關於這個”Controlled”(受控制的)的元件的事件觸發，目前看到有在不同瀏覽器上的事件觸發不連續情況，我也有發一個&lt;a href=&quot;https://github.com/facebook/react/issues/8683&quot;&gt;議題(Issue)&lt;/a&gt;給 React 官方。或許比較好的治本方案，是需要從 state 更動方式的內部程式碼，或是人造事件觸發的順序，進行一些調整，這超出我的能力範圍，就有待開發團隊的回應了。&lt;/p&gt;
&lt;p&gt;最後，如果你正好有需要到這個功能，或是你認為這個功能有需要，你可以幫忙測試看看或是提供一些建議。我已經把所有的程式碼、展示、線上測試、解決方案都集中到這個 Github 庫的&lt;a href=&quot;https://github.com/eyesofkids/react-compositionevent&quot;&gt;react-compositionevent&lt;/a&gt;中。或許你現在需要一個解決方案，你可以用裡面目前的暫時性解決方式試試也可以。&lt;/p&gt;</content:encoded></item><item><title><![CDATA[為何說setState方法是異步的]]></title><link>https://eddychang.me/why-setstate-is-async/</link><guid isPermaLink="false">https://eddychang.me/why-setstate-is-async/</guid><content:encoded>&lt;blockquote&gt;
&lt;p&gt;註: 2019-3-9 本文撰寫於 React Fiber 改進之前，有點時間了，不過內容仍然可以參考&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;在學習或使用過一陣子 React 後，你可能會發現一個在&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;方法的特性，以下面這個簡單範例來說明:&lt;/p&gt;
&lt;hr id=&quot;system-readmore&quot; /&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;default&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;SelectBox&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;extends&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;React&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;Component&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token function&quot;&gt;constructor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;props&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;state &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token function-variable function&quot;&gt;handleChange&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; e &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

  &lt;span class=&quot;token function&quot;&gt;render&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
      &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;div&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
        &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;select onChange&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;handleChange&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; value&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
          &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;option value&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;JavaScript&quot;&lt;/span&gt; key&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
            JavaScript
          &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;option&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
          &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;option value&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Angular2&quot;&lt;/span&gt; key&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
            Angular2
          &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;option&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
          &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;option value&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;React&quot;&lt;/span&gt; key&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
            React
          &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;option&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
        &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;select&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
        &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;h1&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;h1&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
      &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;div&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;我們在&lt;code class=&quot;language-text&quot;&gt;handleChange&lt;/code&gt;方法中，呼叫&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;來更新選項的值，然後在控制台中輸出這個值。看起來一切都是很符合邏輯，但你如果一執行就會發現，在控制台中輸出的&lt;code class=&quot;language-text&quot;&gt;this.state.value&lt;/code&gt;，並不會在呼叫&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;方法後立即就變動。像下面的執行的結果圖一樣:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/state-d5980af17b56ba4fd791d4aca576b019.gif&quot; alt=&quot;執行結果&quot;&gt;&lt;/p&gt;
&lt;p&gt;當然，如果你直接輸出的是&lt;code class=&quot;language-text&quot;&gt;e.target.value&lt;/code&gt;，一定是正確的值，但在某些情況下，我們要取用的並不是這個事件的值，而是要更動過後的 state(狀態)值。&lt;/p&gt;
&lt;p&gt;如果要在&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;方法後，直接取用更動後的&lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt;值，正確的使用方式，在官方文件中的說明，需要利用&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;的第二參數值，傳入一個 callback 函式，改為像下面這樣的程式碼:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;setState&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; value&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;target&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;另一個方式則是用&lt;code class=&quot;language-text&quot;&gt;componentDidUpdate()&lt;/code&gt;這個生命週期方法，把確定 state 更新後的程式碼放在裡面，如下面的程式碼:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token function&quot;&gt;componentDidUpdate&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;this&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;state&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;value&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;為什麼一定要這樣作的主要原因是:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;這個方法，它在 React 中的執行行為可以認為”異步的”。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;雖然&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;並非使用像使用了&lt;code class=&quot;language-text&quot;&gt;setTimeout&lt;/code&gt;或 promise 的那種進入到事件迴圈(Event loop)的異步執行，但它的執行行為在 React 函式庫中時，的確是異步的，也就是有延時執行的行為。但以官方文件中較為精確的說法，”&lt;strong&gt;它不是保證同步的&lt;/strong&gt;“。&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;方法與包含在其中的執行是一個很複雜的過程，這段程式碼從 React 最初的版本到現在，也有無數次的修改。它的工作除了要更動&lt;code class=&quot;language-text&quot;&gt;this.state&lt;/code&gt;之外，還要負責觸發重新渲染(render)，這裡面要經過 React 核心中 diff 演算法，最終才能決定是否要進行重渲染，以及如何渲染。而且為了批次與效能的理由，多個&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;呼叫有可能在執行過程中還需要被合併，所以它被設計以異步的或延時的來進行執行是相當合理的。&lt;/p&gt;
&lt;p&gt;那麼&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;會在何時以同步的方式來執行，也就是立即更動&lt;code class=&quot;language-text&quot;&gt;this.state&lt;/code&gt;？答案是在 React 函式庫控制之外時，它就會以同步的方式來執行，在下面兩篇文章中，都有類似的例子:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://thereignn.ghost.io/on-the-async-nature-of-setstate-in-react/&quot;&gt;ON THE ASYNC NATURE OF &lt;code class=&quot;language-text&quot;&gt;SETSTATE&lt;/code&gt; IN REACT&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://www.bennadel.com/blog/2893-setstate-state-mutation-operation-may-be-synchronous-in-reactjs.htm&quot;&gt;setState() State Mutation Operation May Be Synchronous In ReactJS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;但大部份的使用情況下，我們都是使用了 React 函式庫中的表單元件，例如 select、input、button 等等，它們都是 React 庫中人造的元件與事件，是處於 React 函式庫的控制之下，在這個情況下，&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;就會以異步的方式執行。所以一般來說，我們會認為&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;就是異步執行，並不是用原始碼來看說它是不是有使用像&lt;code class=&quot;language-text&quot;&gt;setTimeout&lt;/code&gt;或&lt;code class=&quot;language-text&quot;&gt;Promise&lt;/code&gt;之類的方式轉為 JavaScript 的異步執行方式，而是以它在 React 庫的控制之下，以執行行為與順序來認定。&lt;/p&gt;
&lt;p&gt;以下是翻譯自官方 setState 原始碼的註解，官網的說明也是類似的說明:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;不保證&lt;code class=&quot;language-text&quot;&gt;this.state&lt;/code&gt;會立即更新，所以在調用這個方法後存取&lt;code class=&quot;language-text&quot;&gt;this.state&lt;/code&gt;可能會回傳舊的值。&lt;/p&gt;
&lt;p&gt;不保證呼叫&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;就會同步地執行，而它們也可能最終被被批量呼叫(多次呼叫的情況下)。你可以提供額外的回調(callback)，回調(callback)將會在&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;實際被完成時被執行。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;因此，很早就有開發者提出來關於&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;常令初學者感到怪異的執行情況，在某些情況下會造成執行上會看到不連續的結果。除了&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;方法有異步執行的行為外，它還有幾個被提出來特殊行為:&lt;/p&gt;
&lt;h3&gt;1. setState 可能會引發不必要的渲染(renders)&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;的設計是用來更動&lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt;值，也會觸發重新渲染(re-render)，按照邏輯就是反正不管如何，只要開發者呼叫&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;，React 就去作整個視圖的重新渲染就是。所以&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;必定會作重新渲染的執行，只是要如何渲染是由 React 來決定。&lt;/p&gt;
&lt;p&gt;重新渲染(re-render)指的主要是網頁上視圖(View)的重新再呈現，這是 React 原本的核心設計，這個設計是有一些問題的。最主要的是 state(狀態)並不一定單純只用來記錄與視圖(View)有關的狀態，也有可能是某個內部控制用的屬性值，或是只應用內部使用的資料。當你改變了這些與視圖無關的 state(狀態)值，以現在的 React 設計來說，照樣要觸發重新渲染的執行過程，這在某些複雜的應用時，由於造成不必要的渲染，有可能造成效能上的問題。&lt;/p&gt;
&lt;p&gt;當然，React 提供了&lt;code class=&quot;language-text&quot;&gt;shouldComponentUpdate&lt;/code&gt;方法讓開發者可以自行判斷，自行提供對應的解決方式。也有&lt;a href=&quot;https://facebook.github.io/react/docs/perf.html&quot;&gt;Performance Tools&lt;/a&gt;可以進行剖析檢測。算得上是一些補強的作法。&lt;/p&gt;
&lt;h3&gt;2. setState 無法完全掌控應用中所有元件的狀態&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;state&lt;/code&gt;(狀態)是獨立於每個元件內部的，而且它是個不能直接更動的物件值，這個設計當然是為了要保持元件的封裝與獨立性，但所以如果當要開發一個複雜的應用時，必定需要使用那些能掌控所有元件資料，以及能提供各元件間資料互動的函式庫，例如 Flux, Redux 或 MobX 等等。&lt;/p&gt;
&lt;p&gt;React 元件目前只能透過各種生命週期的方法，與外部資源、計時器或 DOM 事件來進行掛勾(Hook)，這些都無法直接使用&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;方法來進行，因此&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;並沒有辦法完全掌控一個應用中所有元件的狀態，它像是每個元件中的都有的一種接口方法，單純要依靠&lt;code class=&quot;language-text&quot;&gt;setState&lt;/code&gt;方法來管控整個 React 應用，完全是不足夠的。&lt;/p&gt;
&lt;p&gt;以上說明參考自這篇文章: &lt;a href=&quot;https://medium.com/@mweststrate/3-reasons-why-i-stopped-using-react-setstate-ab73fc67a42e#.hfcnguohj&quot;&gt;3 Reasons why I stopped using React.setState&lt;/a&gt;&lt;/p&gt;</content:encoded></item><item><title><![CDATA[JavaScript裡的語句用分號結尾是個選項嗎]]></title><link>https://eddychang.me/js-semicolon/</link><guid isPermaLink="false">https://eddychang.me/js-semicolon/</guid><content:encoded>&lt;p&gt;在JS裡的分號(;)是什麼作用？總結一下，它既是語句(表達式)的分隔，也可以作為語句的結尾。但只認為分號(;)就一定是語句的結尾是有疑問的…&lt;/p&gt;
&lt;h2&gt;起因&lt;/h2&gt;
&lt;p&gt;這個文章一開始回覆於這篇回答中: &lt;a href=&quot;https://segmentfault.com/q/1010000007250960/a-1020000007266418&quot;&gt;javascript初級問題&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;也有之前的朋友寫信來問，因為在讀到我寫的一本電子書: &lt;a href=&quot;https://www.gitbook.com/book/eyesofkids/javascript-start-from-es6/details&quot;&gt;從ES6開始的JavaScript學習生活&lt;/a&gt;，繁體，gitbook。我在寫作風格里有說明，這本電子書中的範例都是使用”不用分號(;)作為程式碼語句的結尾”的風格。&lt;/p&gt;
&lt;p&gt;所以我把所有的內容整理出來到這篇文章，並針對一些常見的反對問題作解說回答。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;覺得寫得好的朋友請分享給你的朋友。這些知識是很基本的，但可惜一直被忽視。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;前言&lt;/h2&gt;
&lt;p&gt;先說明我並沒有要大家都來不加分號，而是回答”為什麼可以不加分號”，或是”為何分號是選項可有可無？“，或是”分號是在何時可以不加？何時又一定要加？何時又算多加了？“等問題。&lt;/p&gt;
&lt;p&gt;“不用分號作語句結尾”並不是”完全不使用分號”，而是該加的時候加，不該加的時候不加，不用分號作為語句結尾。實際上，我如果在改寫別人的原始碼或是像原本函式庫(如jquery)的風格是有用分號(;)時，為了統一撰寫風格，也是會加的，基本上自己最近寫的ES6、 React、Redux等就不用分號(;)結尾。&lt;/p&gt;
&lt;h2&gt;分號(;)的作用&lt;/h2&gt;
&lt;p&gt;在JS裡的分號(;)是什麼作用？總結一下，它既是語句(表達式)的分隔，也可以作為語句的結尾。&lt;/p&gt;
&lt;p&gt;但只認為分號(;)就一定是語句的結尾是有疑問的，下面這兩個例子就是典型範例，也是很常見的錯誤:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//有問題的例子&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;add&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; a &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; b &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;
    a &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; b&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;或是像下面這個，也是很常見的錯誤示範:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//有問題的例子&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      test&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;這兩例的函式回傳值必為&lt;code class=&quot;language-text&quot;&gt;undefined&lt;/code&gt;，而不是應該回傳的值&lt;code class=&quot;language-text&quot;&gt;3&lt;/code&gt;與物件。為何？因為你有看到return先換行(Enter鍵)，再接著要回傳的值了嗎？也就是說這兩個代碼在執行時，相當於下面這樣的代碼(我只寫一個出來，另一例相同):&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;return&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; test&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;return&lt;/code&gt;因為先換了一行，視為語句結尾，所以根本沒有可回傳的值，也就是在上例子中，Enter鍵(\n)先把&lt;code class=&quot;language-text&quot;&gt;return&lt;/code&gt;結尾掉了，後面你加的分號(;)是結尾到下一行的。這邏輯代表Enter鍵(\n)在這一句語句結尾這功用上，比分號(;)還優先。&lt;/p&gt;
&lt;p&gt;那為何Enter鍵(\n)或換行，可以作為語句的結尾？來源是由於ECMAScript的自動插入分號(Automatic Semicolon Insertion, 以下簡稱ASI)的標準。在語句或一段代碼敘述後，加了Enter鍵(\n)後，JS剖析器會在執行期間自動幫你插入分號，這樣理解了嗎？所以不是Enter鍵(\n)的事，是因為自動幫你加分號作結尾了。&lt;/p&gt;
&lt;p&gt;自動插入分號(ASI)這個規則一直在網上有爭議，有一群人認為它是個容易造成誤解的設計，有一群人認為它這設計是正確的應該多多利用，不需要在一般情況下再多此一舉，在語句後面加上分號(;)。不管你是支持哪一種，我認為都需要理解其中的內容，作為一個稱職的JS開發者，這是很基礎的知識。&lt;/p&gt;
&lt;h2&gt;自動插入分號(ASI)的5種例外情況&lt;/h2&gt;
&lt;p&gt;這裡討論的就是用Enter鍵(\n)或斷行來作為語句的結尾，自動插入分號(Automatic Semicolon Insertion)標準的特例情況。在以下的5種情況是用Enter鍵(\n)或換行，是&lt;strong&gt;不會&lt;/strong&gt;作自動插入分號來讓語句作結尾。雖是說”例外情況”，但大概也是每天都看得到，只是常不知道為何會這樣而已，看了你就知道了。大致說明如下:&lt;/p&gt;
&lt;h3&gt;1. 當這一行的語句是沒關閉的情況&lt;/h3&gt;
&lt;p&gt;例如陣列、物件文字字面、圓括號之類使用情況，或是最後是個點號(.)或逗號(,)時，也就是如果把這行結尾，就會產生不合法語句的情況。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;注: 遇到等號(=)算未完整的表述式，如果指定值在下一行也會略過自動插入分號結尾作用&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;這種例子很常見，通常是在分開內容太長的語句，或是讓值寫得清楚的時候。我舉下面的兩個合法語法範例，你會很容易理解Enter鍵(\n)會在何時自動結尾，雖然這些例子看起來是不好閱讀的例子，一般情況我們會用來分隔比較長的語句:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//第一例&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; a &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;//第二例&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;test&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
c&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;c
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;2. 這一行是 ++ 或 —&lt;/h3&gt;
&lt;p&gt;這規則是很怪異的，從來沒看過有人這樣寫過。 JS會認為++與—在這一行是要準備來運算執行下一行的值，所以不結尾。下面是個合法範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;a&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;--&lt;/span&gt;
a
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;3. 這一行是for()、while()、do、if()或else，但沒有用花括號({})時&lt;/h3&gt;
&lt;p&gt;這簡寫語法也很常見，每天都會用到，是個當花括號({})區塊中執行代碼不多時用的語法。以下為範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;null&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;undefined&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
   console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
   console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;4. 下一行的開頭是([)、(()、(+)、(*)、(/)、(-)、(,)、(.)，或二進位運算子(例如~ &amp;#x26; |)，可以與這行組成一個表達式時&lt;/h3&gt;
&lt;p&gt;以下為範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;function test(){
  return 1
         +2
         -3
}
console.log(test())&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;下面這個例子剛好與第一點顛倒的寫法，也很常見，也是一個用於長語句分隔的寫法。有人喜歡用這種的寫法，有些人喜歡用第一點的寫法:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;var a =
[1
,2
,]&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;5. 空白語句，不會自動插入分號作結尾&lt;/h3&gt;
&lt;p&gt;這與上面第3點有相關，有時候會看到有人犯了這個常見錯誤。下面是個錯誤例子，不論&lt;code class=&quot;language-text&quot;&gt;if&lt;/code&gt;這行與&lt;code class=&quot;language-text&quot;&gt;else&lt;/code&gt;這行間有沒有換行，或是換了幾百行，都不會自動插入分號作結尾:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//錯誤例子&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;不過，你可以加上分號在&lt;code class=&quot;language-text&quot;&gt;if(...)&lt;/code&gt;這行最後，讓語法合法可執行。但沒見過有人這樣用，大概要控制流程邏輯不對才會這樣寫。下面為合法例子:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//合法例子&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;i &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token boolean&quot;&gt;false&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;以上為用Enter鍵(\n)作為語句結尾的的5個例外情況，其他都會自動幫你插入分號作結尾。&lt;/p&gt;
&lt;p&gt;所以依這個解說，最一開始的例子中的&lt;code class=&quot;language-text&quot;&gt;return&lt;/code&gt;後面多了一個換行就會產生錯誤的回傳值。與&lt;code class=&quot;language-text&quot;&gt;return&lt;/code&gt;可能有相同情況的還有幾個，像&lt;code class=&quot;language-text&quot;&gt;continue&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;break&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;throw&lt;/code&gt;等幾個關鍵字，這些如果先換行，然後在下一行再加分號也是會變成兩個不同的語句，因為在換行時已經自動插入分號結尾掉。&lt;/p&gt;
&lt;p&gt;另一個小常識是，分號(;)除了作為語句結尾或分隔外，它與JS中的其他符號有差異，是它自己本身可以形成一個合法的語句(表達式)。你可以在程式碼裡只輸入一個分號(;)，它是合法而不會有錯誤的，其他的符號(例如:&lt;code class=&quot;language-text&quot;&gt;,:+-*/%&lt;/code&gt;)都會有錯誤。&lt;/p&gt;
&lt;h2&gt;一定要使用分號的情況&lt;/h2&gt;
&lt;p&gt;分號(;)的用處不是只有語句結尾，它在某些語法中，具有分隔表述式或語句的功用。以下情況必用分號(;)。&lt;/p&gt;
&lt;h3&gt;1. for語句圓括號(&lt;code class=&quot;language-text&quot;&gt;()&lt;/code&gt;)中的三個表述式彼此之間:&lt;/h3&gt;
&lt;p&gt;很常用到​​不多說明，以下為例子:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
 &lt;span class=&quot;token comment&quot;&gt;//...&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;2. 在同一行寫兩個語句(表述式)在一起，中間需要分號(;)區隔。&lt;/h3&gt;
&lt;p&gt;所以像&lt;code class=&quot;language-text&quot;&gt;switch&lt;/code&gt;語句中的&lt;code class=&quot;language-text&quot;&gt;case&lt;/code&gt;，如果&lt;code class=&quot;language-text&quot;&gt;break&lt;/code&gt;(或&lt;code class=&quot;language-text&quot;&gt;continue&lt;/code&gt;)要寫在同一行時，&lt;code class=&quot;language-text&quot;&gt;break&lt;/code&gt;(或&lt;code class=&quot;language-text&quot;&gt;continue&lt;/code&gt;)前必加分號(;)。這在語句很短的時很會用到。以下為例子:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//第一例&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;//第二例&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;foo&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;doSomething&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;break&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;3. 以&lt;code class=&quot;language-text&quot;&gt;[&lt;/code&gt;或&lt;code class=&quot;language-text&quot;&gt;(&lt;/code&gt;開頭的行，前面需要加分號(;)&lt;/h3&gt;
&lt;p&gt;這是很特別一種撰寫風格。實際上是一種保護的語法，有時候解譯器或壓縮工具會誤認為某行語句，有開頭&lt;code class=&quot;language-text&quot;&gt;(&lt;/code&gt;的話是準備要作函式呼叫，或開頭&lt;code class=&quot;language-text&quot;&gt;[&lt;/code&gt;是準備要作陣列或物件的存取屬性的事。所以會與上幾行粘在一起剖析，造成代碼執行結果不對或報錯。&lt;/p&gt;
&lt;p&gt;還有另一情況是IIFE，因為IIFE剛好也是用&lt;code class=&quot;language-text&quot;&gt;(&lt;/code&gt;開頭。所以這兩種開頭的語句前，必加分號(;)在語句的最前面，以免造成誤判。不過大概也只有這一個需要特別注意，IIFE你用到的情況有可能會多些。以下為例子:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//第一例&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;x &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; y&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;doSomething&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;​​ b&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; c&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;forEach&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;doSomething&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;//第二例&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; x &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;42&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;參考&lt;a href=&quot;http://stackoverflow.com/questions/1873983/what-does-the-leading-semicolon-in-javascript-libraries-do&quot;&gt;stackoverflow這裡的問答&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2&gt;“不需要”與”一定不能”使用分號的情況&lt;/h2&gt;
&lt;p&gt;接著要理解，什麼時候必”不需要”與”一定不能”使用分號(;)，這也很容易理解的。如果你是都要用分號來作每行語句的結尾，你應該了解一下。&lt;/p&gt;
&lt;h3&gt;1. &lt;code class=&quot;language-text&quot;&gt;for&lt;/code&gt;語句的最後一個(第三個)表達式後面&lt;/h3&gt;
&lt;p&gt;畫蛇添足不多說，一定會造成錯誤，其實這錯誤很難犯，只是網上其他文章有列，所以我把它也列出來。你如果會看到for的圓括號裡最後面會出現分號(;)的合法語法，應該只是省略第三個表達式的寫法。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//錯誤語法&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;//合法語法&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; i&lt;span class=&quot;token operator&quot;&gt;++&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;2. 花括號的結尾符號(})的後面。但有例外，賦值時可以加分號(;)是對的語法。&lt;/h3&gt;
&lt;p&gt;這個規則應該是”不需要”加而已，經測試在Chrome上也不會報錯，算是不建議的語法，這也是個畫蛇添足。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//不建議語法&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;a&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;//正確語法，賦值時使用&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; obj &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;a&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;var&lt;/span&gt; &lt;span class=&quot;token function-variable function&quot;&gt;fun&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;function&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;//正確語法，do...while&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;3. 在if、for、while、或switch的圓括號結尾符號(&lt;code class=&quot;language-text&quot;&gt;)&lt;/code&gt;)後面加上分號(;)&lt;/h3&gt;
&lt;p&gt;這個是合法語法，但整個控制邏輯是錯掉的，這錯誤很也不容易犯到。可以對照到最上面一節的第5個例外情況看看。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;
      &lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//錯誤例子，不過它合法&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hi&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;//上例相當於下面這樣&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;===&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;alert&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;hi&quot;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h2&gt;反對的原因，以及說明&lt;/h2&gt;
&lt;p&gt;以下列出幾個常見的反對”不使用分號作為語句結尾”的原因，以這些原因的解說。不過這些原因，大部份都是因為FUD(懼、惑、疑)，而不是真正以科學實證的角度來作為理由。&lt;/p&gt;
&lt;h3&gt;因為瀏覽器相容問題。舊版的瀏覽器不支持。&lt;/h3&gt;
&lt;p&gt;自動插入分號(ASI)的標準是何時加到ECMAScript的？&lt;/p&gt;
&lt;p&gt;自動插入分號其實是本來就有的語言特性，網上可以找到的2000年的ECMAScript版本3，也就是ES3標準，裡面就有這個&lt;code class=&quot;language-text&quot;&gt;Automatic Semicolon Insertion&lt;/code&gt;章節了。 2000年到現在也十多年了，你說要多舊的瀏覽器才真的不支持，說真的我也找不到。&lt;/p&gt;
&lt;p&gt;根據網上的文章指出，曾經有一小段時間IE6這個在ASI實作上有問題，但後來MS很快修正了，現在我們能用到的IE6是支持的。下圖是在WindowsXP SP3中的IE6瀏覽器中的小小測試，你可以仔細看一下，執行的代碼並沒有用分號來作語句結尾，而且是直接寫在HTML文檔中。&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/ie6-f04de9df6a78f6b3786c819b9c7d99db-891b3.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block; ; max-width: 800px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 72.53401360544217%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAPCAYAAADkmO9VAAAACXBIWXMAAAsSAAALEgHS3X78AAADj0lEQVQ4y12T22scdRTHVxRt2sY2FP0flGipouBDW9NgsaZQ+6BiBYmplrRIEARRCGIfFFohBZ980QdtQcE0tUnbbLQ1SZt7N01Mtpu93zeb7G12d2Z3Z3ZnPp7dbED6gw/nN7/Ld875nXNsN2fWuTmdYGQqxvW7Ma7+E2DwToChyTBDExEhzPXJIMP3ItyakL1RP9dmVIbnilydyQsK9gWFW8KE3LEl4kESsSDBkJtwcI2w/z6JhJtUJkwqFSWbi2JocdY3nMSj00TiGcBCz64ysJzHkbbku0Z9qFoNWz5fpFSuUCqV0QSrpsuW2TxkUtENoYqiauQLWUJxVbaqRLwP+G1smlnHMv8uL8sZnaIqgpgW/x/3QxbDS1VGlnRcgTyPjmS6JtGEmZmbJxYKkkyuo8rPdBHMKroI1v2oi1omNXFs3DHLH7dn5c2cOJbcjfAsa5sasWSF5EaKufkFEV1g1fkQr89PLJ7A6cs2BZtOVkVwczNKwOck4F+Ti8lHAyAQWqeQi7CRTJBMhFGUnDhUk3CVxvtKyGU5ZtTlmlbezqpTba4JlkFV12SuM7uSY2alwKJbZXpFleRpJFIl5tdUFlxFbMPja4ze82Kf8jEm2JuMTHoZHt/i2h0PV0ZWsI+7+PXGJhcHdb77XeXrywUuDSn88GeGH0cy/PKXhLy4MIUv4MUX9OIPefCL9QY8eP1beIRAyE8oGsTj9XHlxhSDtx0M/u3jsn2d0XmNu6tgX7QYc5jYcqkCOcWimCugZMqUVQtTsmNtY5qY1ZqsVcXCma9O8srxvXS++zwnPjpEd9879H5xjr7+fnq/vIitnupAWMfvTpGMlcimQUqTgpRbobiNJd8Weami8z8f5YPzj3Gqv5WTn++g8/RTvPbek7x8YicHulqxKQWDdK4mohnS6SJ5zaSoNQUb1mrMi5qFUhf8qZOeCzY+vdRK7/e7OTuwi3MDu/nkwh56vt0jgvkKmymDgiLhlqQrStIdJQujYmKUdfSyhaZJJ8nckCLo++ZNOk49QVfPPo6fbuPtM8LHbXR1P8NbHz6LrSKdpooXpWJFKsRqVItpbHee2ejCqlGjWt3q1+7PjtHe8TivHtvHS2+0sf/I3gbth4VDT2N76HxAJOwmHvPg863g8SwRjbhIxL243cu4XIv4ZT0ecxOUjL9/9iDPHbZx4Ogu9ne2CDt48UgLL3S00P76Tv4DByL44kp/kpUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px transparent;&quot;
        alt=&quot;ie6&quot;
        title=&quot;&quot;
        src=&quot;/static/ie6-f04de9df6a78f6b3786c819b9c7d99db-48538.png&quot;
        srcset=&quot;/static/ie6-f04de9df6a78f6b3786c819b9c7d99db-bed0f.png 200w,
/static/ie6-f04de9df6a78f6b3786c819b9c7d99db-5fd34.png 400w,
/static/ie6-f04de9df6a78f6b3786c819b9c7d99db-48538.png 800w,
/static/ie6-f04de9df6a78f6b3786c819b9c7d99db-891b3.png 1176w&quot;
        sizes=&quot;(max-width: 800px) 100vw, 800px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;所以，你是聽誰說舊版的瀏覽器不支援的？該不會那個人又說他也是聽說的。謠言止於智者對吧。&lt;/p&gt;
&lt;h3&gt;因為壓縮工具不支持&lt;/h3&gt;
&lt;p&gt;這原因以前的確存在過，有個壓縮工具叫JSMin，是大師Douglas Crockford寫的工具，如果你沒用分號作語句結尾，它是連壓都不壓。當然這是因為Crockford他本來就不太贊​​成不用分號作語句結尾的關係。&lt;/p&gt;
&lt;p&gt;現在老早就沒有這問題了，其他常用的工具如Closure Compiler或webpack中的壓縮外掛工具都可以壓好壓滿，要不然怎麼會有知名的一些大專案(bootstrap, npm, vue.js)也捨棄用分號作語句結尾的情況。&lt;/p&gt;
&lt;p&gt;最近的在JSMin與Bootstrap中的一段代碼爭議在這裡可以看到，JS發明人Brendan Eich的言論立場是會中立些，你有興趣可以進一步看這篇: &lt;a href=&quot;https://brendaneich.com/2012/04/the-infernal-semicolon/&quot;&gt;https://brendaneich.com/2012/04/the-infernal-semicolon/&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;語句都用分號(;)作結尾是一個好的撰寫風格&lt;/h3&gt;
&lt;p&gt;最有名的是從&lt;a href=&quot;http://www.jslint.com/&quot;&gt;JSLint&lt;/a&gt;這個檢查工具開始的，它會檢查你的每個語句的最後是不是用分號(;)來作結尾，如果不是會提出警告信息。&lt;/p&gt;
&lt;p&gt;而提倡在每個語句後面一定要用分號來作結尾的大師級人物，最有名的算是JSON格式發明者Douglas Crockford，&lt;a href=&quot;http://javascript.crockford.com/code.html&quot;&gt;他的這個文章&lt;/a&gt;上有說明，從文章中可以看得出他是反對只使用ASI特性的。 JSLint工具也是他作的，相信也有很多人看過他的大作”JavaScript: 優良部份”。不過，他也提倡了很多風格，例如tab鍵相當於4個空格，但現在一般都用2個空格，或是一行一個var變量定義，而且要按照英文字母排列，不知道有多少人真的是一定這樣作。大師耳提面命的東西，我們小小程序員當然必定是要重視，但並不是照單全收。&lt;/p&gt;
&lt;p&gt;回到我們的問題中，在瀏覽器上能順利執行的代碼語法，為何要檢查工具要強迫認為是有問題的語法？&lt;/p&gt;
&lt;p&gt;如果你都到處都加上分號(;)，卻還會發生有錯誤的情況(例如最上面的典型例子)，那代表起因是來自於對於語言本身的無知，而不能怪罪於語言本身的臭蟲或設計問題。&lt;/p&gt;
&lt;p&gt;現在流行的其他檢查工具，例如ESLint、JSHint等等，就算有這項檢查也有選項可以關閉。這純粹是開發團隊或個人的選擇。&lt;/p&gt;
&lt;h2&gt;結語&lt;/h2&gt;
&lt;p&gt;要不要用分號(;)作為語句的結尾，就視個人習慣或組織團隊規定的撰寫風格了。不管你的選擇為何，都應該理解為何分號(;)是選項而非必要的原因，不要因為大神或社群上大家說要加該加，就埋頭拼命加，而不去理解其中的原因。&lt;/p&gt;
&lt;p&gt;真實情況並不是所有的情況分號作為語句都是選項，而是有規則標準的。JS雖然常常有陷阱，但本質上是固定的東西，標準就已經定在那裡了，上面所說的規則學好，足以應付9成情況，也可以讓你的代碼寫起來更加有信心。&lt;/p&gt;
&lt;p&gt;說句實在話，如果你是個能把加分號(;)的行為減到最少情況，也就是不使用分號作為語句的結尾的開發者，是因為你理解分號(;)在JS中的意義，以及ASI標準的規則。並不是標新立異或追求潮流，也不是為了要少打那幾個符號，更不是為了要讓js檔壓縮後會變小，這純粹是個笑話，完全不會變小，因為壓縮工具會幫你加上分號。&lt;/p&gt;
&lt;p&gt;最後幾句，開放原始碼專案中真的完全不使用分號(;)的專案最近有多起來的現象，但最有名的是大家每天都在用的&lt;code class=&quot;language-text&quot;&gt;npm&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;bootstrap&lt;/code&gt;，還有最近比較熱門的&lt;code class=&quot;language-text&quot;&gt;vue.js&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;redux&lt;/code&gt;這幾個，有興趣可以找找。&lt;/p&gt;
&lt;h2&gt;參考&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;http://blog.izs.me/post/2353458699/an-open-letter-to-javascript-leaders-regarding&quot;&gt;An Open Letter to JavaScript Leaders Regarding Semicolons&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;http://mislav.net/2010/05/semicolons/&quot;&gt;Semicolons in JavaScript are optional&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[SCSS 15分鐘入門]]></title><link>https://eddychang.me/learn-scss-in-15-mins/</link><guid isPermaLink="false">https://eddychang.me/learn-scss-in-15-mins/</guid><content:encoded>&lt;h2&gt;前言&lt;/h2&gt;
&lt;p&gt;SCSS(Sassy CSS，時髦的 CSS)是 SASS 中的一種新式語法，SASS 則是一種針對 CSS 的腳本程式語言，藉由提供程式語言的特性，例如變數、巢狀結構、混合、函式與擴充(繼承)等等，可以預先對 CSS 進行結構化的工作，最後再編譯的網頁上可使用的 CSS 語法。&lt;/p&gt;
&lt;h2&gt;內容&lt;/h2&gt;
&lt;p&gt;SCSS 使用和 CSS 一樣的區塊({})與定義結尾(;)語法，它是基於 CSS 語法的超集(superset)，如果你已經有一些 CSS 語法的基礎，學習 SCSS 會很容易，雖然它有一些類似程式語言的語法，但都相當簡單易用，並沒有太複雜的語法。為了與之前的 SASS 語法作區分，檔案的副檔名使用.scss。(舊語法則使用.sass)&lt;/p&gt;
&lt;p&gt;SCSS 本身需要使用命令列工具進行編譯，這些工具可以與現有的程式開發或網頁編輯程式作搭配使用，支援很多也很廣泛，也有網頁版的線上編輯工具如&lt;a href=&quot;http://www.sassmeister.com/&quot;&gt;SassMeister&lt;/a&gt;或&lt;a href=&quot;http://codepen.io/&quot;&gt;CodePen&lt;/a&gt;，或是專用圖形化介面應用程式。要在自己的電腦上使用 SCSS 通常需要使用兩種工具，一個是用於編譯 SCSS 檔案為 CSS 檔案的”&lt;strong&gt;編譯工具&lt;/strong&gt;“，另一個則是對 SCSS 程式碼的”&lt;strong&gt;語法檢查工具&lt;/strong&gt;“。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;以下的 SCSS 範例，你可以先使用&lt;a href=&quot;http://www.sassmeister.com/&quot;&gt;SassMeister&lt;/a&gt;來複製貼上看看編譯的成果，後面的內容有附工具安裝的說明。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;變數與運算&lt;/h3&gt;
&lt;p&gt;可以用錢號($)來定義變數，用冒號(:)來指定變數的值，這與 CSS 定義屬性值很相似。在檔案中的其他地方就使用這些變數值。&lt;/p&gt;
&lt;p&gt;變數的命名通常使用在 CSS 中常見的屬性名稱寫法，也就是用連接號(-)與全小寫英文，例如&lt;code class=&quot;language-text&quot;&gt;$second-color&lt;/code&gt;，變數在編譯後並不會出現在最後輸出的 CSS 檔案中。&lt;/p&gt;
&lt;p&gt;此外，變數也可以指定給其他變數使用，變數的值也可以是一個字串值，不過解譯時有特別的語法。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//scss&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$color-white&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; #fff&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$color-pink&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; #ee11ab&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$title-font&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; normal 24px/1.5 &lt;span class=&quot;token string&quot;&gt;&apos;Open Sans&apos;&lt;/span&gt;, sans-serif&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token property&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$primary-color&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$color-pink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;a &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$color-white&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$color-pink&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;撰寫時的建議: 對於會套用到整個網站的每個顏色、字體建議都先定義成變數。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;撰寫時的建議: 不要使用像&lt;code class=&quot;language-text&quot;&gt;red&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;blue&lt;/code&gt;的英文字詞來指定顏色，而是要用 16 進位碼來定義，例如&lt;code class=&quot;language-text&quot;&gt;red&lt;/code&gt;應該寫成&lt;code class=&quot;language-text&quot;&gt;#ff0000&lt;/code&gt;。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;撰寫時的建議: 在 CSS 類別中定義時，按照英文字元 A-Za-z 來排列其中的 CSS 樣式定義。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;變數可以再進行作加減乘除餘(&lt;code class=&quot;language-text&quot;&gt;+-*/%&lt;/code&gt;)運算，最特別的是字串與顏色色碼也可以進行運算。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;//scss&lt;/span&gt;
&lt;span class=&quot;token property&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$_num&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 5px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;.container &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$color-pink&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; 2&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;margin&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$_num&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; 2 &lt;span class=&quot;token variable&quot;&gt;$_num&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;撰寫時的建議: 進行運算的運算符號前後要加上空格，不要黏在一團。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;巢狀(Nesting)&lt;/h3&gt;
&lt;p&gt;巢狀語法可以使用明確的階層定義，這種結構在 CSS 中很常見，例如像下面的選單或清單項目的風格定義:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// scss&lt;/span&gt;
&lt;span class=&quot;token selector&quot;&gt;ul &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;list-style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

  &lt;span class=&quot;token selector&quot;&gt;li &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; inline-block&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 15px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

    &lt;span class=&quot;token selector&quot;&gt;a &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; #444&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;font-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 16px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
      &lt;span class=&quot;token property&quot;&gt;text-decoration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;上面的內容會編譯為下面的 CSS 內容:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;css&quot;&gt;
      &lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/* css */&lt;/span&gt;
&lt;span class=&quot;token selector&quot;&gt;ul&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;list-style&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;ul li&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; inline-block&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 15px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;ul li a&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; #444&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;font-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 16px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;text-decoration&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; none&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;因為 CSS 中的巢狀結構會有兩種情況，一種是指包含在某個 DOM 元素之內的，例如上面範例的&lt;code class=&quot;language-text&quot;&gt;ul li a&lt;/code&gt;。而另一種則是指同個 DOM 元素的但不同類別，例如&lt;code class=&quot;language-text&quot;&gt;ul.mylist&lt;/code&gt;或&lt;code class=&quot;language-text&quot;&gt;a:hover&lt;/code&gt;(偽類)。有空格就代表是第一種巢狀的結構，也就是上面的原本的巢狀定義方式。&lt;/p&gt;
&lt;p&gt;第二種巢狀結構是沒有空格，接著在一起的 CSS 定義，這時在巢狀結構語法裡，就需要加入與符號(&amp;#x26;)來定義，代表是黏在一起中間沒有空格的，例如以下的範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// scss&lt;/span&gt;
&lt;span class=&quot;token selector&quot;&gt;.parent &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token selector&quot;&gt;&lt;span class=&quot;token parent important&quot;&gt;&amp;amp;&lt;/span&gt;:hover &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
  &lt;span class=&quot;token selector&quot;&gt;&lt;span class=&quot;token parent important&quot;&gt;&amp;amp;&lt;/span&gt;.other-class &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;上面的內容會編譯為下面的 CSS 內容:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;css&quot;&gt;
      &lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;/* CSS */&lt;/span&gt;
&lt;span class=&quot;token selector&quot;&gt;.parent:hover&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token selector&quot;&gt;.parent.other-class&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;風格建議: 如果你有像&lt;code class=&quot;language-text&quot;&gt;h1.title&lt;/code&gt;或&lt;code class=&quot;language-text&quot;&gt;li.mylist&lt;/code&gt;之類的 CSS 宣告，不論裡面的樣式有多簡單，都應該在 SCSS 檔案中都要列成巢狀結構。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;匯入(Import)&lt;/h3&gt;
&lt;p&gt;匯入其他的 SCSS 檔案，最後編譯時會一併包含進來編譯。要被匯入的通常檔案名稱前會加下底線(_)作區分，這樣編譯工具在編譯時會略過這些檔案，而只會去編譯那些沒下底線(_)的檔案，例如&lt;code class=&quot;language-text&quot;&gt;_reset.scss&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;例如&lt;code class=&quot;language-text&quot;&gt;base.scss&lt;/code&gt;中要匯入&lt;code class=&quot;language-text&quot;&gt;_reset.scss&lt;/code&gt;，&lt;code class=&quot;language-text&quot;&gt;base.scss&lt;/code&gt;的檔案內容會如下，要注意的是只需要寫&lt;code class=&quot;language-text&quot;&gt;@import &amp;#39;reset&amp;#39;&lt;/code&gt;，不用加副檔名或下底線(_)，編譯程式會自動尋找對應的檔案:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;@import&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;reset&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;body &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; #efefef&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;font&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 100% Helvetica, sans-serif&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;註: CSS 中也有&lt;code class=&quot;language-text&quot;&gt;@import&lt;/code&gt;的定義，也可以加入其他的 CSS 檔案，語法有點小差異，詳見&lt;a href=&quot;https://developer.mozilla.org/zh-CN/docs/Web/CSS/@import&quot;&gt;MDN 這裡&lt;/a&gt;的說明。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;混合(Mixin)&lt;/h3&gt;
&lt;p&gt;混合(Mixin)有點像是個函式或是一群值的組合，也可以輸入一個值然後套用這個值的整串結果，經常用於需要相符不同瀏覽器品牌的 CSS3 宣告上，來解決供應商前綴字的問題，例如以下的範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;@mixin&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;border-radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;-webkit-border-radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;-moz-border-radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;-ms-border-radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;border-radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;.box &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;@include&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;border-radius&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;10px&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;要記住的是&lt;code class=&quot;language-text&quot;&gt;@minix&lt;/code&gt;標記需要對應到&lt;code class=&quot;language-text&quot;&gt;@include&lt;/code&gt;標記，上面的&lt;code class=&quot;language-text&quot;&gt;@include border-radius(10px)&lt;/code&gt;可以像變數一樣，加在 scss 檔案中的任一個定義中。&lt;/p&gt;
&lt;p&gt;這個&lt;code class=&quot;language-text&quot;&gt;mixin&lt;/code&gt;中的定義傳入值，是可以加上預設值的，例如以下的範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;@mixin&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;label&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token property&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$text&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Code&apos;&lt;/span&gt;, &lt;span class=&quot;token property&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$background&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$yellow&lt;/span&gt;, &lt;span class=&quot;token property&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$color&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;rgba&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;black, 0.5&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;position&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; relative&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token selector&quot;&gt;&lt;span class=&quot;token parent important&quot;&gt;&amp;amp;&lt;/span&gt;:before &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$background&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;content&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$text&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;display&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; inline-block&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
    &lt;span class=&quot;token property&quot;&gt;font-size&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 0.6rem&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;混合(Mixin)經常被使用，在大部份時候如果你需要整個群組或整個類別的 CSS 套用，主要都是使用它，因為 CSS3 很多新的定義都會有供應商前綴字的問題，網路上也有很多現成的混合庫可以使用，例如以下三種常見的函式庫，但這裡面也不只有混合(Mixin)而已，還有很多其他的內容，直接使用可以節省時間，三種基本上都使用&lt;a href=&quot;https://rubygems.org/&quot;&gt;gem&lt;/a&gt;來安裝:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Bourbon: &lt;a href=&quot;bourbon.io&quot;&gt;bourbon.io&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Compass: &lt;a href=&quot;compass-style.org&quot;&gt;compass-style.org&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Susy: &lt;a href=&quot;susy.oddbird.net&quot;&gt;susy.oddbird.net&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;擴充/繼承(Extend)&lt;/h3&gt;
&lt;p&gt;擴充(Extend)是可以擴充原有的 CSS 類別定義，你可以再加上不同的定義或覆蓋原有的定義，例如下面的範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.message &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;border&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1px solid #ccc&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 10px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; #333&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;.success &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;@extend&lt;/span&gt; .message&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;border-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; green&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;.error &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;@extend&lt;/span&gt; .message&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;border-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; red&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;轉成 CSS 會像下面這樣，你可能會注意到&lt;code class=&quot;language-text&quot;&gt;.message&lt;/code&gt;仍然被保留著:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;css&quot;&gt;
      &lt;pre class=&quot;language-css&quot;&gt;&lt;code class=&quot;language-css&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;.message,
.success,
.error&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;border&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1px solid #ccc&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 10px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; #333&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;.success&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;border-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; green&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;.error&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;border-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; red&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;當不需要那個只被用來的繼承的那個 CSS 類別時，可以使用佔位符(%)來定義這個只被繼承之用的 CSS 類別，像&lt;code class=&quot;language-text&quot;&gt;%message&lt;/code&gt;這樣使用就行了:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token selector&quot;&gt;&lt;span class=&quot;token placeholder&quot;&gt;%message&lt;/span&gt; &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;border&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 1px solid #ccc&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 10px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; #333&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;.success &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;@extend&lt;/span&gt; &lt;span class=&quot;token placeholder selector&quot;&gt;%message&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;border-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; green&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;.error &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;@extend&lt;/span&gt; &lt;span class=&quot;token placeholder selector&quot;&gt;%message&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;border-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; red&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;擴充(Extend)的用法相當簡單，相較於混合(Mixin)它不能傳入值，而且會合併相同的定義在同一個類別之中。&lt;/p&gt;
&lt;h3&gt;函式(Functions)&lt;/h3&gt;
&lt;p&gt;SCSS 中也有&lt;code class=&quot;language-text&quot;&gt;@function&lt;/code&gt;可以定義&lt;a href=&quot;http://sass-lang.com/documentation/file.SASS_REFERENCE.html#function_directives&quot;&gt;自訂的函式&lt;/a&gt;，也有一些簡單的程式語法，例如&lt;code class=&quot;language-text&quot;&gt;@return&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;@if&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;@for&lt;/code&gt;、&lt;code class=&quot;language-text&quot;&gt;@each&lt;/code&gt;等流程控制的特性，以及簡單的運算能力。&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;@function&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calculate-width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$col-span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;@return&lt;/span&gt; 100% &lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$col-span&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;.span-two &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calculate-width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// spans 2 columns, width = 50%&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;.span-three &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;calculate-width&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;3&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;// spans 3 columns, width = 33.3%&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;SCSS 中也內建了許多工具函式，詳見&lt;a href=&quot;http://sass-lang.com/documentation/Sass/Script/Functions.html&quot;&gt;內建函式的清單&lt;/a&gt;，常用的例如按比例加亮顏色的&lt;code class=&quot;language-text&quot;&gt;lighten&lt;/code&gt;與按比例加深顏色的&lt;code class=&quot;language-text&quot;&gt;darken&lt;/code&gt;，裡面有關於顏色、透明度、字串、數字的函式很多。以下為範例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;scss&quot;&gt;
      &lt;pre class=&quot;language-scss&quot;&gt;&lt;code class=&quot;language-scss&quot;&gt;&lt;span class=&quot;token property&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$awesome-blue&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; #2196f3&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;a &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;$awesome-blue&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;padding&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; 10px 15px&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;

&lt;span class=&quot;token selector&quot;&gt;a:hover &lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token property&quot;&gt;background-color&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;darken&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;$awesome-blue&lt;/span&gt;, 10%&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;註解(Comment)&lt;/h3&gt;
&lt;p&gt;用類似程式碼寫法的兩條斜線(//)就可以加入註解。CSS 的話是規定要用&lt;code class=&quot;language-text&quot;&gt;/*...*/&lt;/code&gt;的註解記號，相較之下會簡單些。&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;15 分鐘分隔線~以下的內容將超過 15 分鐘。&lt;/p&gt;
&lt;hr&gt;
&lt;h2&gt;安裝&lt;/h2&gt;
&lt;p&gt;由於大部份的基礎工具一開始都是使用 Ruby 語言開發，所以相關的編譯工具或檢查工具，或是幾套知名的圖形化介面的應用程式，都是要先在電腦上安裝 RubyGem 才能安裝， Ruby 1.9 版本後都有附 RubyGem。(安裝方式: Windows 裝&lt;a href=&quot;http://rubyinstaller.org/downloads&quot;&gt;RubyInstaller&lt;/a&gt;，Mac OS X 用 homebrew 裝 ruby)。不過這幾套知名的圖形化介面應用程式都只有支援 Mac OS X。&lt;/p&gt;
&lt;p&gt;另一種新的選擇則是使用 node 平台的 npm 套件管理程式來安裝所需的工具，這些工具已經很完整的移植到 node 平台上，雖然還不是 100%的與原來的工具相容，但可用程度也很高了。現在很多編輯程式也支援這些 node 上面的工具程式。node 平台(npm)的方式也是支援各種作業系統的，安裝 node.js 就附有 npm 套件管理程式。&lt;/p&gt;
&lt;h3&gt;編譯器 &amp;#x26; 檢查工具&lt;/h3&gt;
&lt;p&gt;原始的 Sass 編譯工具是使用 Ruby 語言寫的，後來的則有新的 LibSass 專案則是以 C/C++寫的函式庫，可以很方便地移植到不同的程式語言平台中。&lt;/p&gt;
&lt;p&gt;你可以先安裝 Ruby 後用 gem 指令安裝&lt;code class=&quot;language-text&quot;&gt;gem install sass&lt;/code&gt;，而另一個&lt;a href=&quot;https://github.com/brigade/scss-lint&quot;&gt;scss-lint&lt;/a&gt;工具則是另一個用 Ruby 寫的檢查工具，安裝方式類似。&lt;/p&gt;
&lt;p&gt;另一個選擇是當如果你有使用 node 進行開發的話，可以用 npm 來安裝&lt;a href=&quot;https://github.com/sass/node-sass&quot;&gt;node-sass&lt;/a&gt;編譯工具套件，再搭配&lt;a href=&quot;https://github.com/sasstools/sass-lint&quot;&gt;sass-lint&lt;/a&gt;的檢查套件。這兩個工具與上面的那種功能是相同的，視需求選擇其中一種即可，像我個人平常是有在開發 JavaScript 應用程式，所以是直接選擇用 node-sass 與 sass-lint 工具。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;註: scss-lint 與 sass-lint 這兩個套件沒事名字實在取得太像，很容易搞混。前面是 RubyGem 的套件，後面是 npm 的套件，看你要用那種平台，不要裝錯了。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3&gt;檢查工具的規則&lt;/h3&gt;
&lt;p&gt;配合檢查工具所使用的檢查規則是在專案裡使用一個名稱為&lt;code class=&quot;language-text&quot;&gt;.scss-lint.yml&lt;/code&gt;(RubyGem 套件)或&lt;code class=&quot;language-text&quot;&gt;.sass-lint.yml&lt;/code&gt;(npm 套件)的檔案來設定，通常要有這個檔案在專案中，才會開始進行檢查。&lt;/p&gt;
&lt;p&gt;基本的規則可以到&lt;a href=&quot;https://github.com/brigade/scss-lint#configuration&quot;&gt;scss-lint&lt;/a&gt;專案或&lt;a href=&quot;https://github.com/sasstools/sass-lint/blob/master/lib/config/sass-lint.yml&quot;&gt;sass-lint&lt;/a&gt;專案複製。&lt;/p&gt;
&lt;p&gt;不過&lt;code class=&quot;language-text&quot;&gt;.scss-lint.yml&lt;/code&gt;與&lt;code class=&quot;language-text&quot;&gt;sass-lint.yml&lt;/code&gt;格式有點差異，如果需要轉換可以使用&lt;a href=&quot;https://github.com/sasstools/make-sass-lint-config&quot;&gt;make-sass-lint-config&lt;/a&gt;工具轉換。&lt;/p&gt;
&lt;p&gt;所謂的檢查並不光只是對語法錯誤的即時檢查，比較多的情況都是一些撰寫風格上的建議與提醒訊息。檢查工具的部份我會建議你使用與程式碼編輯工具搭配的套件，會比較容易使用，用命令列指引來檢查實在滿麻煩的。&lt;/p&gt;
&lt;h2&gt;命令列編譯工具的使用&lt;/h2&gt;
&lt;p&gt;與所有的命令列工具一樣，提供很多的參數可以在編譯時選擇使用，一般常用的編譯指令有下面幾個，因為原本的 sass 工具與 node-sass 有一些不同，所以分別列出來。實務上會直接用到指令的情況不多，也同樣會使用程式碼編輯程式中的外掛輔助功能，這裡只是提供一些簡單的參考。&lt;/p&gt;
&lt;h3&gt;單個檔案編譯&lt;/h3&gt;
&lt;p&gt;以 sass 為例，語法參數參考在&lt;a href=&quot;http://sass-lang.com/documentation/file.SASS_REFERENCE.html#syntax&quot;&gt;這裡&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;sass input.scss output.css&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;以 node-sass 為例，語法參數參考在&lt;a href=&quot;https://github.com/sass/node-sass#command-line-interface&quot;&gt;這裡&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;node-sass src/style.scss dest/style.css&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;對目錄中所有檔案編譯&lt;/h3&gt;
&lt;p&gt;如果要編譯整個目錄中的 scss 檔案到另一個目錄中時:&lt;/p&gt;
&lt;p&gt;以 sass 為例，要使用&lt;code class=&quot;language-text&quot;&gt;--update&lt;/code&gt;參數&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;sass --update scss:css&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;以 node-sass 為例，需要加上&lt;code class=&quot;language-text&quot;&gt;--output&lt;/code&gt;指定輸出目錄:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;node-sass scss/ --output css/&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;監控目錄中有修改的檔案進行編譯&lt;/h3&gt;
&lt;p&gt;這兩種工具都提供監控(—watch)的參數，意思是當檔案(.scss)有更動時，自動編譯有更動的檔案。監控不僅可以用在單一檔案上，也可以針對目錄中的所有檔案。不過這個指令一輸入就要一直開著命令列視窗才有效。&lt;/p&gt;
&lt;p&gt;以 sass 為例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;sass --watch scss:css&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;p&gt;以 node-sass 為例:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;
      &lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;node-sass --watch scss/ -o css/&lt;/code&gt;&lt;/pre&gt;
      &lt;/div&gt;
&lt;h3&gt;其他的參數&lt;/h3&gt;
&lt;p&gt;有兩種選項可以在編譯時提供更多的彈性，一種是輸出的風格。sass 工具使用的是&lt;code class=&quot;language-text&quot;&gt;--style&lt;/code&gt;參數，而 node-sass 使用的是&lt;code class=&quot;language-text&quot;&gt;--output-style&lt;/code&gt;參數。風格都有以下四種:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;nested: 一般的 CSS 樣式，帶有以空白隔出的巢狀結構。&lt;/li&gt;
&lt;li&gt;expanded: 一般的 CSS 樣式。&lt;/li&gt;
&lt;li&gt;compact: 一般的 CSS 樣式，緊湊的排列，會把每個類別中的所有定義寫在同一行中。&lt;/li&gt;
&lt;li&gt;compressed: 經過壓縮的 CSS 樣式。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;另一個選項是輸出原始碼地圖(sourcemap)檔案或內容的選項，原始碼地圖(sourcemap)是用來進行除錯使用的。sass 工具使用的是&lt;code class=&quot;language-text&quot;&gt;--sourcemap&lt;/code&gt;，而 node-sass 除了&lt;code class=&quot;language-text&quot;&gt;--source-map&lt;/code&gt;參數還有其他的幾種選項。&lt;/p&gt;
&lt;h2&gt;常見編輯程式的外掛&lt;/h2&gt;
&lt;h3&gt;Atom 相關外掛&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;sass-autocompile: 存檔時自動或是用快捷鍵編譯，支援.scss 或.sass 副檔名的檔案。(需額外安裝 npm 套件 node-sass 在全域中)&lt;/li&gt;
&lt;li&gt;css-snippets: CSS, SCSS, Sass, Less 程式碼片段或函式快速輸入。&lt;a href=&quot;https://github.com/dsandstrom/atom-css-snippets/blob/master/snippets/css-snippets.cson&quot;&gt;表列&lt;/a&gt;。&lt;/li&gt;
&lt;li&gt;atom-beautify: 漂亮格式化工具。&lt;/li&gt;
&lt;li&gt;autocomplete-sass: 給 SASS 用的 CSS 屬性名稱與數值自動完成(提示建議)&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;檢查工具(擇一):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;linter-sass-lint: 檢查工具外掛，搭配 node sass-lint(npm 套件)&lt;/li&gt;
&lt;li&gt;linter-scss-lint: 檢查工具外掛，搭配 scss-lint(RubyGem 套件)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Sublime Text 3&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/packages/Sass&quot;&gt;Sass&lt;/a&gt;: 高亮度顯示與語法自動完成(提示建議)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/packages/SassBuilder&quot;&gt;Sass​Builder&lt;/a&gt;: 編譯輔助工具。需要先安裝 sass 編譯工具，而且需要有設定檔，參考說明文件。&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/packages/SassBeautify&quot;&gt;Sass​Beautify&lt;/a&gt;: 漂亮格式化工具。&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://packagecontrol.io/packages/SASS%20Snippets&quot;&gt;SASS Snippets&lt;/a&gt;: 程式碼片段或函式快速輸入。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Webstorm&lt;/h3&gt;
&lt;p&gt;內建基本的編輯高亮度顯示支援，可搭配外部的編譯工具進行編譯，請見這篇官網的&lt;a href=&quot;https://www.jetbrains.com/help/webstorm/2016.2/transpiling-sass-less-and-scss-to-css.html&quot;&gt;說明文件&lt;/a&gt;&lt;/p&gt;
&lt;h3&gt;Visual Studio Code(VSC)&lt;/h3&gt;
&lt;p&gt;內建基本的編輯高亮度顯示支援，可搭配外部的編譯工具進行編譯，請見這篇官網的&lt;a href=&quot;https://code.visualstudio.com/Docs/languages/css&quot;&gt;說明文件&lt;/a&gt;。其他的套件例如:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=robinbentley.sass-indented&quot;&gt;Sass&lt;/a&gt;: 高亮度顯示與語法自動完成(提示建議)&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=glen-84.sass-lint&quot;&gt;Sass Lint&lt;/a&gt;: 搭配 sass-lint(npm 套件)的檢查工具&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://marketplace.visualstudio.com/items?itemName=dbalage.vscode-stylesheet-formatter&quot;&gt;Stylesheet Formatter&lt;/a&gt;: 漂亮格式化工具。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Visual Studio 2015&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://visualstudiogallery.msdn.microsoft.com/3b329021-cd7a-4a01-86fc-714c2d05bb6c&quot;&gt;Web Compiler&lt;/a&gt;: 用於編譯 SASS 檔案的擴充。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3&gt;Dreamweaver&lt;/h3&gt;
&lt;p&gt;Dreamweaver 2015/CC 不支援，要使用另外的工具搭配。不過正在測試中的新版本已有加入支援，請見&lt;a href=&quot;https://blogs.adobe.com/creativestation/web-dreamweaver-sass-compile-and-options&quot;&gt;這篇 2016.8 日文的新版本特性說明&lt;/a&gt;，內容中可以下載測試版本。&lt;/p&gt;
&lt;h3&gt;Brackets&lt;/h3&gt;
&lt;p&gt;內建基本的編輯高亮度顯示支援，也有套件可以配合檢查工具。&lt;/p&gt;
&lt;h2&gt;結語&lt;/h2&gt;
&lt;p&gt;看到這裡記得開始安裝與使用吧，坐而言不如起而行。&lt;/p&gt;</content:encoded></item></channel></rss>